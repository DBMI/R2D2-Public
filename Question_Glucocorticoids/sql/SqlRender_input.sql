/************************************************************************************************************

Modifications made by Kai Post k1post@health.ucsd.edu 10/02/2020 for compatibility with SQLRender:
                        
Example of getting this query ready to run using RStudio and SQLRender:
library(SqlRender)
query19SqlTemplate <- render(SqlRender::readSql("~/git/R2D2-Queries/Question_0019/sql/SqlRender_input.sql"))

*************************************************************************************************************

Project:	R2D2
Create date: 07/16/2020
Question number: Question_0019
Question in Text: "For patients with covid-19 related hospitalizations, what is the mortality rate by use of 
	steroid immuosuppresant & mortality, stratified by age group/gender/ethnicity/race?"

Database: SQL Server

Author name: Rob Follett
Author GitHub username: rfollett
Author email: rfollett@mednet.ucla.edu
Version : 3.1

Last modified date: 08/11/2020 - Using new hospitalization logic from Q000
					10/02/2020 - Removing Otic, Inhaled, Rectal/Enema, Nasal, and Topical concepts

Instructions: 
-------------

Initialize variables: 
	i) Please change the site number of your site
	ii) Please change threshold for minimum counts to be displayed in the results. Possible values are 0 or 11.
	Default value is 0 (ie no cell suppression). When value is 11, result cell will display [1-10].


Section 1: Create a base cohort

Section 2: Prepare concept sets

Section 3: Design a main body
	
Section 4: Report in a tabular format


Updates in this version:
-------------------------
1) Used R2D2 COVID-19 concept sets and hospitalization definition instead of local institutional definition
2) Removed [0-17] age category
3) Added an additional column 'Outcome_name' to display the outcome name
4) All demographic categories are displayed in the results even if counts are 0
5) Added result cell suppression logic

*************************************************************************************************************/

-- DO NOT UPDATE THESE
{DEFAULT @version = 3.1}
{DEFAULT @queryExecutionDate = (select getdate())}

-- UPDATE THESE
{DEFAULT @cdm_schema = 'OMOP_v5.OMOP5'} -- Target OMOP CDM database + schema
{DEFAULT @r2d2_schema = 'OMOP_v5.R2D2'} -- Target OMOP R2D2 database + schema
{DEFAULT @vocab_schema  = 'OMOP_Vocabulary.vocab_51'} -- Target OMOP CDM Vocabulary database + schema
{DEFAULT @sitename = 'Site10'}
{DEFAULT @minAllowedCellCount = 0}      --Threshold for minimum counts displayed in results. Possible values are 0 or 11

/************************************************************************************************************* 
	Section 1: Get COVID hospitalizations using R2D2 concept sets 
**************************************************************************************************************/

drop table if exists #covid_hsp;
create table #covid_hsp (
		visit_occurrence_id bigint 
		, person_id bigint
		, visit_concept_id bigint
		, visit_start_datetime datetime
		, visit_end_datetime datetime
		, discharge_to_concept_id bigint
		, discharge_to_source_value varchar(256)
		, AgeAtVisit int
		, cohort_start_date datetime
		, days_bet_COVID_tst_hosp int
		, death_datetime datetime
		, Hospital_mortality int
		, rownum int
	);


insert into #covid_hsp (visit_occurrence_id, person_id, visit_concept_id, visit_start_datetime, visit_end_datetime
		, discharge_to_concept_id, discharge_to_source_value, AgeAtVisit,  cohort_start_date, days_bet_COVID_tst_hosp 
		, death_datetime, Hospital_mortality, rownum)
exec @r2d2_schema.sp_identify_hospitalization_encounters	--- gets COVID hospitalizations


/************************************************************************************************************* 
	Section 2: Concept sets specific to question (R2D2 Atlas)
**************************************************************************************************************/

/************************************************************************************************************* 
	Concept sets for glucocorticoids (R2D2 Atlas) Concept Set #788 and then filtered by Dr. Bell to remove
	terms for topical, inhaler, cream, paste, ophthalmic and pad.
	http://atlas-covid19.ohdsi.org/#/conceptset/788/details
**************************************************************************************************************/

	--  COVID-19 Atlas concept sets 
	if object_id('tempdb.dbo.#glucocorticoid') is not null drop table #glucocorticoid 

	select c.* 
	into #glucocorticoid
	from @vocab_schema.concept c
	where concept_id in (
1113120,	1146889,	1150806,	1150807,	1150862,	1150865,	1178729,	1193333,	1193334,	1193335,	1193340,	1193369,	1194734,	1506270,	1506312,	1506314,	1506315,	1506316,	1506426,	1506430,
1506472,	1506473,	1506474,	1506475,	1506476,	1506477,	1506478,	1506479,	1506513,	1506516,	1506520,	1506576,	1507705,	1507706,	1507707,	1507711,	1507732,	1507733,	1507734,	1507735,
1507736,	1507737,	1507738,	1518254,	1518257,	1518258,	1518259,	1518261,	1518292,	1518293,	1518491,	1518525,	1518603,	1518604,	1518605,	1518606,	1518607,	1518608,	1518609,	1518610,
1518611,	1518642,	1518643,	1518644,	1518645,	1518646,	1518647,	1518651,	1518682,	1518683,	1518684,	1518685,	1518686,	1518687,	1518689,	1518690,	1518691,	1518714,	1518715,	1518742,
1518745,	1518746,	1518747,	1518751,	1518851,	1518872,	1550557,	1550560,	1550561,	1550572,	1550581,	1550652,	1550654,	1550716,	1550717,	1550719,	1550720,	1550775,	1550777,	1550778,
1550779,	1550780,	1550915,	1550916,	1550917,	1550918,	1550919,	1550943,	1550944,	1550945,	1550946,	1550947,	1550948,	1550949,	1550950,	1550951,	1550975,	1550980,	1551004,	1551006,
1551007,	1551008,	1551010,	1551011,	1551042,	1551043,	1551044,	1551045,	1551046,	1551051,	1551093,	1551098,	1551099,	1551100,	1551101,	1551122,	1551123,	1551170,	1551171,	1551192,
1551193,	1551195,	1551196,	1551197,	1551198,	1551199,	1551200,	1551201,	1551232,	1551233,	1551234,	1592239,	1592240,	1592241,	1592242,	1592243,	1592244,	1592245,	1592246,	1592247,
1592248,	1592249,	1592250,	1592251,	1592252,	1592253,	1592254,	1592255,	1592256,	1592257,	1592258,	1592259,	1592260,	1592261,	19001446,	19001447,	19001448,	19002013,	19005824,	19006540,
19006571,	19006572,	19006573,	19006606,	19006938,	19006939,	19006940,	19006961,	19006962,	19006963,	19006964,	19006965,	19006966,	19006967,	19007003,	19007004,	19007005,	19007006,	19007007,	19007008,
19007009,	19007010,	19007061,	19007062,	19009116,	19009117,	19009119,	19009120,	19010639,	19011127,	19015780,	19015801,	19016533,	19016866,	19016867,	19018083,	19018084,	19018906,	19019158,	19019692,
19019891,	19019892,	19019893,	19019894,	19020402,	19021121,	19021122,	19021571,	19022370,	19022881,	19022882,	19022929,	19023479,	19024533,	19024534,	19025451,	19026063,	19026064,	19027186,	19027187,
19027188,	19027189,	19027190,	19027213,	19027214,	19027215,	19027280,	19028399,	19028933,	19029017,	19029656,	19029657,	19029659,	19029909,	19029973,	19030001,	19030003,	19030005,	19030008,	19031623,
19031961,	19031962,	19032449,	19032450,	19032573,	19032638,	19033379,	19033380,	19033622,	19033788,	19033819,	19033841,	19034011,	19034012,	19034013,	19034014,	19034021,	19034027,	19034196,	19034197,
19034203,	19034204,	19034205,	19034231,	19034232,	19034327,	19034328,	19034645,	19034646,	19034647,	19034648,	19034650,	19034803,	19034804,	19034805,	19034806,	19034807,	19035282,	19037464,	19038300,
19039286,	19039383,	19039743,	19040080,	19040123,	19040124,	19040156,	19040157,	19040242,	19040967,	19041535,	19042519,	19042857,	19043287,	19043289,	19043290,	19043313,	19043315,	19043316,	19043317,
19043318,	19043320,	19043346,	19043347,	19043348,	19043349,	19043371,	19043372,	19043374,	19043507,	19043508,	19043509,	19043531,	19043532,	19043850,	19044143,	19045921,	19045957,	19047315,	19047317,
19047753,	19047754,	19047760,	19047795,	19047796,	19047824,	19047826,	19047963,	19048393,	19048394,	19048397,	19048398,	19048399,	19048691,	19050907,	19050908,	19050909,	19050910,	19050941,	19052207,
19052208,	19052272,	19052278,	19052279,	19052473,	19052580,	19052715,	19053009,	19053476,	19053595,	19053596,	19054212,	19054922,	19055344,	19055347,	19055348,	19055349,	19055350,	19056328,	19056330,
19056414,	19056451,	19057671,	19058164,	19058668,	19059580,	19059601,	19059604,	19059610,	19059634,	19059640,	19059681,	19059685,	19059686,	19059688,	19059726,	19059753,	19059754,	19059755,	19060779,
19061119,	19061120,	19061218,	19061353,	19061357,	19061358,	19061425,	19061517,	19061549,	19061578,	19061580,	19061583,	19061618,	19061619,	19061622,	19061653,	19061654,	19061691,	19061907,	19061909,
19061952,	19062339,	19062371,	19062372,	19062373,	19062690,	19062987,	19063117,	19063119,	19063670,	19063762,	19063770,	19063870,	19063892,	19063927,	19064110,	19064249,	19064799,	19065036,	19065985,
19066846,	19067155,	19067188,	19067189,	19067190,	19067555,	19067727,	19067728,	19067729,	19067730,	19067751,	19067752,	19067753,	19067754,	19067755,	19067756,	19067757,	19067758,	19067759,	19067760,
19067791,	19067792,	19067793,	19067794,	19067795,	19069346,	19070310,	19070678,	19070679,	19070931,	19070932,	19071438,	19071469,	19072647,	19072648,	19072791,	19072837,	19072839,	19073018,	19073069,
19074157,	19074184,	19074185,	19074763,	19074770,	19074792,	19075030,	19075849,	19076095,	19076121,	19076135,	19076136,	19076145,	19076917,	19076982,	19077020,	19077782,	19078054,	19078058,	19078060,
19078084,	19078086,	19078088,	19078111,	19078115,	19078141,	19078142,	19078293,	19078350,	19078371,	19078412,	19079404,	19079481,	19079489,	19080181,	19080565,	19080569,	19080591,	19080702,	19080745,
19081460,	19081471,	19081472,	19081625,	19081627,	19081630,	19081860,	19082356,	19082564,	19082890,	19082976,	19082977,	19083056,	19083125,	19083175,	19083176,	19083579,	19083661,	19083989,	19084229,
19084372,	19084373,	19084526,	19084748,	19084816,	19084817,	19084825,	19084826,	19085031,	19085082,	19085227,	19085298,	19085371,	19085551,	19085786,	19085840,	19085928,	19086197,	19086249,	19086888,
19086911,	19086912,	19087427,	19087429,	19087451,	19087452,	19087453,	19087454,	19087455,	19088174,	19088731,	19088901,	19088971,	19088972,	19088976,	19089054,	19089061,	19089062,	19089063,	19089064,
19089065,	19089451,	19089452,	19089689,	19090523,	19090524,	19090525,	19090526,	19090623,	19091192,	19091242,	19091759,	19091760,	19091880,	19092830,	19093396,	19093425,	19093625,	19093652,	19093653,
19093712,	19093724,	19093831,	19095136,	19095151,	19095559,	19095651,	19095716,	19095717,	19095718,	19095811,	19095812,	19095813,	19095979,	19096439,	19096935,	19097091,	19097275,	19097852,	19097857,
19098058,	19098154,	19098197,	19098198,	19098918,	19099970,	19100321,	19101279,	19101595,	19101719,	19101885,	19101886,	19101887,	19101991,	19103651,	19103718,	19104122,	19104123,	19104309,	19104487,
19104491,	19104623,	19104629,	19104630,	19105393,	19105671,	19105911,	19106202,	19106203,	19106204,	19106649,	19106650,	19106651,	19106652,	19106690,	19106692,	19106693,	19106694,	19106829,	19107310,
19107560,	19107561,	19107562,	19107654,	19107660,	19107677,	19107818,	19107858,	19108479,	19108490,	19108506,	19108508,	19108591,	19108592,	19108990,	19108992,	19108993,	19108994,	19109001,	19109114,
19109240,	19109288,	19109290,	19109386,	19109387,	19109391,	19109448,	19109470,	19109489,	19109490,	19109493,	19109784,	19109785,	19109794,	19109805,	19109973,	19109974,	19109975,	19109976,	19109978,
19109979,	19109983,	19109984,	19109985,	19110032,	19110101,	19110115,	19110247,	19110248,	19110249,	19110251,	19110256,	19110325,	19110389,	19110847,	19110848,	19110892,	19110973,	19111173,	19111612,
19111614,	19111617,	19111626,	19111642,	19111643,	19111644,	19111647,	19111649,	19111650,	19111651,	19111657,	19111975,	19112078,	19112080,	19112198,	19112260,	19112268,	19112480,	19112486,	19112502,
19112511,	19113164,	19113720,	19113763,	19113764,	19113790,	19113791,	19113805,	19113806,	19114037,	19114213,	19114215,	19114216,	19114227,	19114612,	19114672,	19115026,	19115460,	19115461,	19115543,
19115554,	19115555,	19115558,	19115584,	19115586,	19115591,	19115592,	19115593,	19115594,	19115785,	19115786,	19115787,	19116151,	19116152,	19116153,	19116154,	19116155,	19116156,	19116157,	19116158,
19116163,	19116164,	19116165,	19116166,	19116364,	19116365,	19116457,	19117024,	19117207,	19117427,	19117428,	19117813,	19117911,	19117914,	19117916,	19117918,	19117921,	19117981,	19117982,	19118090,
19118099,	19118100,	19118101,	19118103,	19118108,	19118110,	19118111,	19118112,	19118145,	19118280,	19118291,	19118409,	19118446,	19118641,	19118695,	19118696,	19118697,	19118711,	19118716,	19118736,
19118759,	19118761,	19118765,	19119910,	19119988,	19119989,	19119990,	19119991,	19119992,	19120000,	19120004,	19120058,	19120064,	19120341,	19120343,	19120348,	19120349,	19120353,	19120461,	19120561,
19120572,	19120573,	19120574,	19120576,	19120577,	19120583,	19120584,	19120585,	19120586,	19120587,	19120588,	19120626,	19120731,	19120824,	19120837,	19120843,	19120864,	19120885,	19121075,	19121101,
19121383,	19121384,	19121385,	19121519,	19121837,	19121838,	19122159,	19122656,	19122719,	19122734,	19122781,	19122782,	19122856,	19123032,	19123117,	19124041,	19124218,	19125148,	19125226,	19125245,
19125246,	19125539,	19125543,	19125545,	19125771,	19126169,	19126208,	19126326,	19126788,	19127696,	19127774,	19127775,	19127835,	19128780,	19128781,	19128896,	19129069,	19129102,	19129398,	19129772,
19129883,	19129988,	19130000,	19130001,	19131602,	19131603,	19131604,	19131605,	19131653,	19132093,	19132094,	19132463,	19132464,	19132476,	19133284,	19133287,	19133538,	19133827,	19133854,	19134690,
19135618,	21021050,	21021096,	21021097,	21021098,	21021099,	21021100,	21021102,	21021103,	21021104,	21021105,	21021110,	21021111,	21021112,	21021113,	21021115,	21021117,	21021120,	21021121,	21021125,
21021128,	21022439,	21022442,	21022443,	21022445,	21026103,	21026104,	21026164,	21026165,	21026170,	21026179,	21026180,	21026183,	21027989,	21027990,	21027991,	21027992,	21027997,	21028105,	21028107,
21028108,	21028112,	21028113,	21028486,	21028496,	21028497,	21028499,	21028501,	21028709,	21028732,	21029961,	21030045,	21030768,	21030799,	21030800,	21030813,	21030814,	21030815,	21030816,	21030817,
21030820,	21030821,	21030822,	21030823,	21030824,	21030826,	21030827,	21030828,	21030829,	21030830,	21030831,	21032177,	21032178,	21032179,	21032180,	21032184,	21032187,	21035895,	21035896,	21035955,
21035960,	21035962,	21035963,	21037782,	21037786,	21037913,	21037914,	21037915,	21037916,	21037917,	21037921,	21038287,	21038293,	21038294,	21038295,	21038514,	21038537,	21038538,	21039468,	21040643,
21040673,	21040697,	21040698,	21040699,	21040700,	21040701,	21040702,	21040705,	21040706,	21040707,	21040708,	21040709,	21040710,	21040711,	21040712,	21040713,	21040714,	21040715,	21040716,	21042124,
21042128,	21042129,	21042130,	21042133,	21045746,	21045747,	21045801,	21045802,	21045803,	21045808,	21045809,	21045810,	21045811,	21047745,	21047747,	21048121,	21048130,	21048340,	21048341,	21048396,
21048436,	21048437,	21048518,	21048634,	21049605,	21049667,	21050393,	21050438,	21050439,	21050456,	21050457,	21050458,	21050459,	21050461,	21050464,	21050465,	21050466,	21050467,	21050468,	21050469,
21050470,	21050471,	21050475,	21050480,	21051863,	21051868,	21051870,	21051871,	21055570,	21055572,	21055573,	21055575,	21055583,	21055588,	21057413,	21057415,	21057417,	21057418,	21057547,	21057548,
21057909,	21058267,	21058268,	21058368,	21058369,	21059044,	21059467,	21060246,	21060247,	21060277,	21060278,	21060279,	21060280,	21060292,	21060293,	21060294,	21060295,	21060298,	21060299,	21060300,
21060303,	21060304,	21060305,	21060311,	21060316,	21061655,	21061656,	21061657,	21061658,	21061659,	21061660,	21061661,	21061662,	21061668,	21061669,	21061670,	21061671,	21061672,	21061673,	21061674,
21061676,	21061679,	21061683,	21065352,	21065353,	21065407,	21065408,	21065413,	21065416,	21065417,	21065418,	21067261,	21067262,	21067264,	21067268,	21067381,	21067383,	21067384,	21067385,	21067387,
21067780,	21067781,	21067799,	21068027,	21068028,	21068029,	21068030,	21068127,	21068210,	21068211,	21068238,	21068306,	21068974,	21069345,	21070183,	21070223,	21070241,	21070242,	21070243,	21070245,
21070246,	21070247,	21070248,	21070250,	21070251,	21070252,	21070253,	21070254,	21070255,	21070256,	21070257,	21070258,	21070259,	21070260,	21070261,	21070265,	21070266,	21070267,	21070268,	21070269,
21070270,	21070271,	21070272,	21070273,	21070274,	21070278,	21070280,	21071595,	21071596,	21071597,	21071598,	21071599,	21071600,	21071601,	21075273,	21075274,	21075275,	21075347,	21075353,	21075356,
21075359,	21077153,	21077272,	21077279,	21077280,	21077646,	21077647,	21077648,	21077664,	21077665,	21077666,	21077832,	21077938,	21077939,	21078101,	21078107,	21078119,	21079170,	21079893,	21079931,
21079932,	21079955,	21079956,	21079957,	21079958,	21079959,	21079960,	21079961,	21079962,	21079964,	21079965,	21079968,	21079969,	21079970,	21079971,	21079972,	21079973,	21081305,	21081306,	21081307,
21081309,	21081312,	21081313,	21085004,	21085073,	21085078,	21085080,	21086900,	21086901,	21086904,	21087011,	21087012,	21087013,	21087348,	21087352,	21087584,	21087847,	21088477,	21088478,	21089622,
21089623,	21089670,	21089671,	21089672,	21089673,	21089674,	21089675,	21089678,	21089679,	21089680,	21089681,	21089682,	21089686,	21089687,	21089688,	21089689,	21089690,	21089691,	21089692,	21089696,
21089698,	21091041,	21091042,	21091043,	21091044,	21091045,	21094847,	21094848,	21094849,	21094850,	21094862,	21094863,	21094864,	21096663,	21096664,	21096670,	21096671,	21096788,	21097155,	21097156,
21097176,	21097387,	21097404,	21097581,	21097582,	21097606,	21098694,	21098772,	21099521,	21099571,	21099572,	21099573,	21099574,	21099575,	21099576,	21099578,	21099579,	21099580,	21099584,	21099585,
21099586,	21099587,	21099588,	21099589,	21099590,	21099591,	21099593,	21099594,	21099595,	21099596,	21099597,	21099603,	21099605,	21099612,	21100964,	21100966,	21100967,	21100968,	21100969,	21100970,
21100971,	21100972,	21100973,	21104727,	21104740,	21104741,	21104743,	21104744,	21106521,	21106522,	21106525,	21106626,	21106627,	21106629,	21107007,	21107249,	21107263,	21107264,	21107535,	21107539,
21109379,	21109429,	21109434,	21109436,	21109437,	21109438,	21109440,	21109442,	21109443,	21109444,	21109445,	21109446,	21109449,	21109452,	21110799,	21110802,	21114520,	21114525,	21116290,	21116291,
21116401,	21116402,	21116741,	21116755,	21116756,	21116758,	21116759,	21117062,	21117063,	21117187,	21117206,	21117268,	21118342,	21119059,	21119118,	21119119,	21119120,	21119122,	21119123,	21119129,
21119130,	21119131,	21119132,	21119133,	21119134,	21119135,	21119136,	21119137,	21119139,	21119141,	21119143,	21119144,	21120468,	21120469,	21120474,	21120475,	21120476,	21124062,	21124124,	21124125,
21124132,	21124133,	21124134,	21124140,	21126126,	21126128,	21126129,	21126130,	21126512,	21126521,	21126720,	21126721,	21126742,	21126743,	21126827,	21126828,	21127001,	21127009,	21128879,	21128901,
21128902,	21128903,	21128904,	21128906,	21128907,	21128908,	21128909,	21128910,	21128912,	21128913,	21128914,	21128915,	21128916,	21128917,	21128918,	21128919,	21128920,	21128921,	21128925,	21128931,
21128932,	21130235,	21130236,	21130237,	21130238,	21130241,	21133943,	21134011,	21134019,	21134021,	21135873,	21135988,	21135989,	21136375,	21136382,	21136397,	21136630,	21136802,	21136831,	21137953,
21138776,	21138777,	21138778,	21138779,	21138799,	21138801,	21138802,	21138803,	21138804,	21138805,	21138806,	21138809,	21138810,	21138811,	21138812,	21138813,	21138814,	21138815,	21138816,	21138817,
21138822,	21138823,	21138824,	21138825,	21138826,	21138827,	21140164,	21140169,	21140170,	21140171,	21140172,	21140173,	21140174,	21140177,	21140178,	21140180,	21140181,	21140182,	21143859,	21143923,
21143924,	21143930,	21143934,	21145718,	21145719,	21145720,	21145860,	21145861,	21145862,	21145865,	21145866,	21146243,	21146254,	21146255,	21146273,	21146473,	21146755,	21148589,	21148646,	21148648,
21148649,	21148650,	21148651,	21148652,	21148653,	21148654,	21148655,	21148656,	21148657,	21148659,	21148660,	21148661,	21148662,	21148663,	21148669,	21148670,	21148672,	21150008,	21150009,	21150010,
21150011,	21150013,	21150014,	21150015,	21150018,	21150019,	21150020,	21153808,	21153881,	21153883,	21153884,	21153885,	21155687,	21155688,	21155690,	21155691,	21155810,	21155814,	21156215,	21156432,
21156450,	21156527,	21156722,	21156724,	21156728,	21157795,	21158589,	21158590,	21158591,	21158592,	21158593,	21158595,	21158596,	21158597,	21158598,	21158599,	21158600,	21158601,	21158602,	21158603,
21158604,	21158608,	21158610,	21158612,	21158613,	21158619,	21158621,	21158622,	21159966,	21159968,	21163619,	21163620,	21163684,	21163685,	21163689,	21163690,	21163691,	21163692,	21165500,	21165501,
21165502,	21165503,	21165505,	21165506,	21165616,	21165990,	21165991,	21165992,	21165994,	21166009,	21166010,	21166200,	21166201,	21166218,	21166260,	21166401,	21166470,	21167582,	21167583,	21167584,
21168339,	21168340,	21168371,	21168389,	21168390,	21168393,	21168396,	21168397,	21168400,	21168401,	21168402,	21168403,	21168404,	21168407,	21168408,	21168409,	21168414,	21168415,	21168416,	21168417,
21168419,	21168421,	21169760,	21169761,	21169762,	21169763,	21169767,	21169768,	21169769,	21169771,	21169772,	21173387,	21173388,	21173389,	21173454,	21173455,	21173456,	21173457,	21173458,	21173469,
21175217,	21175218,	21175334,	21175335,	21175337,	21175732,	21175744,	21176022,	21176069,	21176138,	21176167,	21176250,	21176262,	21602728,	21602729,	21602730,	21602731,	21602732,	21602733,	21602734,
21602735,	21602736,	21602737,	21602738,	21602739,	21602740,	21602741,	21602742,	21602743,	21602744,	35604729,	35604741,	35606531,	35606532,	35606533,	35606536,	35606537,	35606538,	35606540,	35606541,
35606542,	35606544,	35606545,	35606547,	35606548,	35606592,	35745111,	35745112,	35745114,	35745115,	35745116,	35745117,	35745118,	35745119,	35745782,	35746403,	35746404,	35746405,	35746406,	35749308,
35749310,	35749311,	35749312,	35749963,	35749964,	35750567,	35750568,	35752984,	35753473,	35753474,	35753475,	35753476,	35753477,	35754167,	35754791,	35754792,	35754793,	35757650,	35757652,	35757653,
35757654,	35758282,	35758283,	35758902,	35758903,	35758904,	35761825,	35761826,	35761829,	35761830,	35762488,	35763122,	35763614,	35765904,	35765905,	35765907,	35766596,	35767212,	35767213,	35767756,
35769727,	35770221,	35770222,	35771554,	35771555,	35774481,	35774482,	35774483,	35776631,	35777483,	35786264,	35787386,	36211788,	36211789,	36212191,	36212192,	36212193,	36214941,	36214942,	36218739,
36218740,	36218741,	36220296,	36220297,	36220857,	36220858,	36220859,	36222256,	36222257,	36236720,	36236721,	36884729,	36889955,	36892649,	40010223,	40010224,	40012593,	40017873,	40018136,	40018148,
40018149,	40018160,	40018161,	40018163,	40018165,	40018167,	40018168,	40018860,	40018861,	40018864,	40018865,	40018866,	40018867,	40018868,	40018869,	40018870,	40019090,	40019099,	40019100,	40019101,
40019102,	40020791,	40020792,	40020793,	40020968,	40022326,	40022327,	40022479,	40022480,	40025524,	40026665,	40026666,	40026667,	40026668,	40027148,	40027149,	40027151,	40027152,	40027452,	40027453,
40027454,	40027455,	40027461,	40028260,	40028264,	40028266,	40028561,	40028569,	40028574,	40028575,	40028577,	40028598,	40028599,	40028600,	40028601,	40028602,	40028604,	40028865,	40028866,	40030154,
40041493,	40044443,	40046782,	40049686,	40049687,	40049688,	40049689,	40049690,	40049691,	40049692,	40049693,	40049698,	40049699,	40049700,	40049701,	40049702,	40054909,	40054910,	40055571,	40055572,
40059478,	40060701,	40060702,	40060704,	40060705,	40060710,	40060728,	40060730,	40070931,	40070932,	40072752,	40073185,	40073190,	40073191,	40073192,	40073193,	40073194,	40073195,	40073196,	40073197,
40073198,	40073199,	40073200,	40073201,	40073202,	40073203,	40073204,	40073436,	40073437,	40073438,	40073439,	40073454,	40073455,	40073456,	40073457,	40073458,	40073459,	40073460,	40073461,	40073529,
40073530,	40073531,	40073532,	40073533,	40073806,	40073807,	40073808,	40073809,	40073810,	40073811,	40073812,	40077886,	40077887,	40085175,	40085179,	40085180,	40085182,	40085185,	40085186,	40085187,
40085188,	40085193,	40085194,	40085197,	40085198,	40085501,	40085503,	40085504,	40085505,	40085506,	40085516,	40085517,	40085519,	40085520,	40095885,	40102083,	40107134,	40107135,	40109740,	40110591,
40112721,	40112724,	40119172,	40122517,	40122518,	40122519,	40122520,	40122521,	40122522,	40122600,	40127030,	40130114,	40135413,	40136334,	40139039,	40141448,	40143531,	40145460,	40145461,	40145462,
40146099,	40146415,	40146416,	40147400,	40149642,	40150051,	40153448,	40153792,	40154093,	40154981,	40155457,	40160929,	40160930,	40160931,	40160932,	40160933,	40160934,	40163009,	40163010,	40163406,
40163407,	40167743,	40167744,	40167745,	40167746,	40167747,	40167748,	40167909,	40168005,	40168724,	40169495,	40170093,	40171266,	40171267,	40171268,	40171269,	40171270,	40171296,	40173027,	40173039,
40173040,	40173041,	40173042,	40173363,	40173366,	40173367,	40174833,	40174834,	40184254,	40184255,	40184256,	40184346,	40223221,	40223870,	40224101,	40225702,	40225703,	40225766,	40225769,	40225770,
40225771,	40225772,	40226246,	40226254,	40226255,	40226256,	40226257,	40226258,	40226265,	40226266,	40226267,	40226268,	40226537,	40226538,	40226539,	40226541,	40226547,	40226548,	40226549,	40226550,
40226561,	40226562,	40226563,	40226564,	40226565,	40226628,	40226630,	40226633,	40226634,	40226637,	40226638,	40226642,	40226643,	40226649,	40226713,	40226714,	40227406,	40227407,	40227410,	40227411,
40227414,	40227415,	40227422,	40227423,	40227424,	40227425,	40227426,	40227427,	40227430,	40227431,	40227495,	40228089,	40228300,	40228301,	40228302,	40228303,	40228390,	40228391,	40228392,	40228393,
40230688,	40230690,	40231132,	40231133,	40231134,	40231136,	40231769,	40231770,	40231771,	40231772,	40231783,	40231784,	40231785,	40232617,	40233165,	40233170,	40233171,	40233172,	40233173,	40233219,
40233946,	40233947,	40233948,	40233949,	40233950,	40233951,	40233952,	40233953,	40233954,	40233958,	40233959,	40233970,	40233971,	40233972,	40233973,	40233974,	40233975,	40233976,	40233980,	40233981,
40233983,	40233984,	40233985,	40233986,	40233987,	40233988,	40233991,	40233992,	40234004,	40234005,	40234006,	40234007,	40234008,	40234009,	40234021,	40234022,	40234023,	40234024,	40234025,	40234026,
40234027,	40234029,	40234030,	40234031,	40234032,	40234033,	40234034,	40234035,	40234036,	40234037,	40234038,	40234039,	40234040,	40234041,	40234042,	40234043,	40234044,	40234045,	40234046,	40234047,
40234048,	40234049,	40234050,	40234051,	40234052,	40234053,	40234054,	40234055,	40234056,	40234057,	40234058,	40234059,	40234060,	40234061,	40234062,	40234063,	40234064,	40234065,	40234066,	40234067,
40234068,	40234069,	40234070,	40234071,	40234072,	40234073,	40234074,	40234075,	40234076,	40234077,	40234078,	40234079,	40234080,	40234081,	40234082,	40234083,	40234090,	40234091,	40234092,	40234093,
40234094,	40234095,	40234096,	40234097,	40234098,	40234099,	40234100,	40234101,	40234102,	40234104,	40234558,	40234716,	40234720,	40234721,	40234722,	40234723,	40234724,	40234725,	40234726,	40234737,
40234739,	40234740,	40234741,	40234742,	40234743,	40234744,	40234745,	40234790,	40234791,	40234792,	40234793,	40234794,	40234795,	40234796,	40234797,	40234798,	40234799,	40234800,	40234801,	40234802,
40234803,	40234804,	40234805,	40234806,	40234807,	40234808,	40234809,	40234810,	40234811,	40234812,	40234813,	40234814,	40234815,	40234816,	40234817,	40234818,	40234819,	40234820,	40234821,	40234822,
40234823,	40234824,	40234825,	40235163,	40235164,	40235167,	40235895,	40236754,	40237061,	40237064,	40239006,	40239007,	40239008,	40239009,	40239014,	40239015,	40239016,	40239145,	40239148,	40239443,
40239444,	40239745,	40240652,	40240653,	40240656,	40241179,	40241180,	40241184,	40241185,	40241221,	40241503,	40241504,	40241505,	40243304,	40243744,	40243943,	40243944,	40243957,	40243959,	40244439,
40244440,	40244441,	40244442,	40244451,	40822226,	40822869,	40823035,	40823097,	40824287,	40824398,	40825342,	40825955,	40826406,	40834501,	40834502,	40835202,	40837105,	40841316,	40841321,	40841326,
40841327,	40841329,	40841330,	40841331,	40841332,	40841831,	40841832,	40841833,	40843453,	40843460,	40843462,	40843463,	40843464,	40843475,	40843476,	40843477,	40845203,	40847597,	40847602,	40848027,
40849562,	40849563,	40849564,	40852465,	40852466,	40852470,	40852475,	40852476,	40852477,	40852482,	40852483,	40852484,	40852485,	40852486,	40852487,	40852488,	40852489,	40852490,	40852491,	40853714,
40853715,	40853716,	40853717,	40853718,	40853722,	40853723,	40853724,	40853725,	40853726,	40853727,	40853728,	40854568,	40854569,	40855733,	40855738,	40855863,	40856718,	40856719,	40857811,	40862764,
40865633,	40865634,	40865920,	40866340,	40866948,	40867951,	40872470,	40872471,	40872472,	40872478,	40872498,	40872499,	40872503,	40872513,	40872514,	40872515,	40872516,	40872517,	40872544,	40874697,
40874698,	40874699,	40874703,	40874704,	40874705,	40874706,	40874707,	40874708,	40874709,	40878695,	40878947,	40880787,	40883716,	40883726,	40883727,	40883728,	40883729,	40883739,	40883740,	40883741,
40883742,	40883743,	40883744,	40884942,	40884943,	40884944,	40884945,	40884946,	40884947,	40884948,	40884949,	40884954,	40884955,	40884956,	40884957,	40884958,	40884959,	40884960,	40884961,	40884962,
40885884,	40887050,	40887051,	40887117,	40887271,	40887272,	40887273,	40888042,	40888043,	40890657,	40890658,	40896801,	40896802,	40896811,	40896823,	40897108,	40897109,	40897487,	40897488,	40897489,
40903487,	40903521,	40903522,	40903523,	40903524,	40903525,	40903526,	40903527,	40903545,	40904042,	40905621,	40905634,	40905635,	40907295,	40909691,	40909695,	40909696,	40909697,	40909700,	40914647,
40914652,	40914653,	40914654,	40914655,	40914656,	40914662,	40914663,	40914664,	40914665,	40914666,	40914668,	40915853,	40915854,	40915855,	40915856,	40915857,	40915858,	40915859,	40915860,	40915861,
40915864,	40915865,	40915866,	40915867,	40915868,	40915869,	40915870,	40915871,	40916776,	40917954,	40917955,	40917956,	40917998,	40918936,	40927812,	40927813,	40927814,	40927815,	40927820,	40927821,
40927824,	40927825,	40928076,	40929193,	40930143,	40930340,	40931194,	40931195,	40934701,	40934725,	40934733,	40934734,	40934736,	40934737,	40934738,	40934739,	40934740,	40934755,	40934756,	40935291,
40936901,	40936902,	40936903,	40936915,	40936916,	40936917,	40938635,	40938636,	40938651,	40941073,	40941074,	40941075,	40941336,	40946024,	40946035,	40946036,	40946037,	40946038,	40946039,	40946041,
40946042,	40946043,	40946044,	40946045,	40947246,	40947250,	40947251,	40947252,	40947260,	40947261,	40947262,	40947263,	40947264,	40947265,	40947266,	40947267,	40947268,	40947269,	40948171,	40949294,
40949295,	40949303,	40950177,	40951138,	40955045,	40955071,	40959099,	40959111,	40959398,	40959853,	40961639,	40962471,	40962472,	40965854,	40965855,	40965856,	40965857,	40965890,	40965892,	40965893,
40965894,	40965895,	40965896,	40965897,	40965919,	40965920,	40966453,	40966454,	40968026,	40968027,	40968028,	40968034,	40968035,	40968036,	40969685,	40969686,	40969704,	40972028,	40972029,	40972030,
40976969,	40976978,	40976979,	40976980,	40976981,	40976982,	40976991,	40976992,	40976993,	40976994,	40976995,	40976996,	40976997,	40976998,	40976999,	40977000,	40978235,	40978236,	40978237,	40978243,
40978244,	40978245,	40978246,	40978247,	40978248,	40979100,	40979101,	40979102,	40979103,	40980292,	40980302,	40980486,	40981277,	40981278,	40983958,	40990625,	40991744,	40992701,	40997176,	40997195,
40997196,	40997197,	40997198,	40997201,	40997208,	40997209,	40997210,	40997211,	40997212,	40997213,	40997214,	40997234,	40997235,	40997236,	40997237,	40997238,	40997239,	40997240,	40999352,	40999358,
40999359,	40999360,	40999369,	40999370,	40999371,	40999372,	41000998,	41003381,	41003382,	41005428,	41008328,	41008339,	41008340,	41008341,	41008342,	41008352,	41008353,	41008354,	41008355,	41008356,
41008357,	41008358,	41009581,	41009582,	41009583,	41009584,	41009585,	41009586,	41009587,	41009591,	41009592,	41009593,	41009594,	41009595,	41009596,	41009597,	41009598,	41009599,	41011635,	41012566,
41012567,	41021301,	41021302,	41021601,	41022030,	41022031,	41022680,	41023663,	41023669,	41023698,	41023968,	41023969,	41028233,	41028234,	41028235,	41028236,	41028253,	41028259,	41028260,	41028265,
41028266,	41028267,	41028268,	41028269,	41028270,	41028271,	41028281,	41028282,	41028283,	41028822,	41030380,	41030382,	41030384,	41030385,	41030386,	41030387,	41030388,	41030389,	41030397,	41030398,
41030399,	41032084,	41032119,	41034497,	41034501,	41034502,	41036475,	41039416,	41039417,	41039418,	41039425,	41039426,	41039427,	41039430,	41039431,	41039432,	41039433,	41039434,	41039436,	41040657,
41040658,	41040659,	41040665,	41040666,	41040667,	41040668,	41040669,	41041544,	41041545,	41042724,	41042732,	41042733,	41042784,	41046470,	41052519,	41052527,	41052531,	41052540,	41052849,	41052850,
41052851,	41052852,	41053297,	41053973,	41054910,	41055985,	41055986,	41059449,	41059467,	41059476,	41059478,	41059479,	41059480,	41059481,	41059482,	41059495,	41059496,	41059982,	41059983,	41059984,
41059985,	41061508,	41061513,	41061514,	41061515,	41061516,	41061518,	41061519,	41065616,	41065617,	41065618,	41065619,	41065620,	41070693,	41070704,	41070705,	41070713,	41070714,	41070715,	41070716,
41070717,	41070718,	41070719,	41070720,	41071919,	41071920,	41071921,	41071922,	41071926,	41071927,	41071928,	41071929,	41071930,	41071931,	41072808,	41072809,	41074063,	41074263,	41077752,	41077891,
41081278,	41084115,	41084116,	41084132,	41084133,	41084855,	41084856,	41084860,	41085522,	41091033,	41091034,	41091035,	41091065,	41091072,	41091073,	41091074,	41091075,	41091088,	41091089,	41091576,
41091577,	41093120,	41093121,	41093122,	41093123,	41093124,	41093125,	41093135,	41093136,	41094833,	41097167,	41097168,	41097240,	41097605,	41097606,	41099180,	41099181,	41099182,	41099183,	41102126,
41102127,	41102128,	41102135,	41102136,	41102137,	41102138,	41102139,	41102140,	41102141,	41103354,	41103355,	41103356,	41103362,	41103363,	41103364,	41103365,	41103366,	41103367,	41104285,	41104286,
41109170,	41112522,	41115357,	41115363,	41115364,	41115649,	41115650,	41116099,	41116100,	41116101,	41117722,	41117723,	41118746,	41122169,	41122189,	41122190,	41122191,	41122202,	41122203,	41122204,
41122205,	41122211,	41122212,	41122717,	41124296,	41124297,	41124305,	41124306,	41124307,	41128512,	41128513,	41133474,	41133475,	41133482,	41133485,	41133486,	41133491,	41133492,	41133493,	41133494,
41133495,	41133496,	41134794,	41134795,	41134796,	41134797,	41134798,	41134800,	41134801,	41134802,	41134803,	41135694,	41135695,	41135696,	41135697,	41135698,	41135699,	41135701,	41136913,	41136914,
41137102,	41137103,	41146896,	41146897,	41146898,	41146899,	41146900,	41146911,	41147173,	41147174,	41147609,	41147611,	41149177,	41149178,	41149500,	41153703,	41153704,	41153734,	41153735,	41153736,
41153743,	41153745,	41153746,	41153747,	41153748,	41153749,	41153765,	41153766,	41154269,	41155859,	41155861,	41155862,	41155868,	41155869,	41155870,	41155871,	41157554,	41159941,	41159942,	41159943,
41159951,	41160199,	41160384,	41160385,	41161933,	41164800,	41164804,	41164809,	41164810,	41164811,	41164812,	41164814,	41166055,	41166056,	41166057,	41166058,	41166059,	41166060,	41166061,	41166062,
41166063,	41166064,	41166069,	41166070,	41166071,	41166072,	41166957,	41166958,	41166959,	41166961,	41175057,	41177851,	41177865,	41178636,	41178642,	41180277,	41184728,	41184758,	41184759,	41184760,
41184761,	41184766,	41184768,	41184769,	41184770,	41184771,	41184772,	41184773,	41184774,	41184783,	41184784,	41186924,	41186925,	41186926,	41186937,	41186939,	41191069,	41191084,	41191085,	41191527,
41193128,	41196146,	41196147,	41196154,	41196155,	41196156,	41196160,	41196161,	41196162,	41196163,	41197415,	41197416,	41197417,	41197418,	41197419,	41197420,	41197427,	41197428,	41197429,	41197430,
41197431,	41198300,	41198301,	41199684,	41200475,	41201425,	41203265,	41209360,	41209376,	41209377,	41209383,	41209657,	41209658,	41209659,	41210054,	41210056,	41212671,	41216047,	41216048,	41216049,
41216074,	41216075,	41216082,	41216083,	41216084,	41216085,	41216086,	41216087,	41216088,	41216089,	41216103,	41216627,	41218177,	41218179,	41218180,	41218186,	41218187,	41218188,	41218189,	41219844,
41222190,	41222191,	41222195,	41222266,	41224136,	41224137,	41224138,	41224139,	41227219,	41227226,	41227227,	41227228,	41227236,	41227237,	41227238,	41227239,	41227240,	41227241,	41228472,	41228473,
41228474,	41228475,	41228476,	41228477,	41228478,	41228485,	41228486,	41228487,	41228488,	41228489,	41229380,	41230580,	41230587,	41230588,	41230589,	41230590,	41231524,	41234153,	41237411,	41240320,
41240344,	41240345,	41240619,	41247080,	41247081,	41247082,	41247107,	41247114,	41247115,	41247116,	41247117,	41247118,	41247134,	41247135,	41247656,	41249178,	41249179,	41249181,	41249182,	41249183,
41249190,	41249191,	41249192,	41249193,	41249195,	41250844,	41253150,	41253151,	41253152,	41255151,	41258018,	41258021,	41258022,	41258023,	41258024,	41258028,	41258029,	41258030,	41258031,	41259296,
41259297,	41259298,	41259299,	41259300,	41259304,	41259305,	41259306,	41259307,	41259308,	41259309,	41260196,	41260197,	41261486,	41261487,	41262275,	41267259,	41271177,	41271178,	41271191,	41271201,
41271444,	41271858,	41271859,	41273500,	41273799,	41277910,	41277911,	41277912,	41277929,	41277930,	41277931,	41277932,	41277938,	41277942,	41277943,	41277944,	41277945,	41277946,	41277959,	41279987,
41279997,	41279998,	41279999,	41284128,	41284144,	41284145,	41284146,	41284147,	41284148,	41284149,	41286170,	41286171,	41289135,	41289145,	41289146,	41289148,	41289149,	41289150,	41290389,	41290390,
41290391,	41290392,	41290393,	41290394,	41290395,	41290397,	41290398,	41290399,	41290400,	41290401,	41291287,	41292455,	41292456,	41292463,	41292576,	41292627,	41293442,	41302297,	41302298,	41302308,
41302313,	41302993,	41303657,	41303659,	41304565,	41304566,	41304567,	41304568,	41304607,	41304890,	41309158,	41309159,	41309162,	41309170,	41309171,	41309172,	41309173,	41309174,	41309175,	41309193,
41309700,	41309701,	41309702,	41311328,	41311329,	41311333,	41311335,	41311336,	41311337,	41313064,	41313092,	41315379,	41315393,	41315394,	41315395,	41315396,	41315401,	41317493,	41317494,	41317495,
41317496,	41320467,	41320474,	41320476,	41320477,	41320478,	41320479,	41320480,	41320481,	41320482,	41320483,	41320484,	41320485,	41320486,	41320487,	41320488,	41321695,	41321704,	41321705,	41321707,
41321708,	41321709,	41322619,	41322620,	41323797,	41323798,	41323799,	41323809,	41323858,	41324807,	41324808,	41324809,	41324810,	41327538,	41327551,	41327718,	41327738,	41327772,	41328007,	41328369,
41328401,	41328402,	41328838,	41329695,	41329696,	41330165,	41331092,	41331290,	41331481,	41331497,	41331498,	41332160,	41332324,	41332325,	41332444,	41332842,	41332843,	41333018,	41333060,	41333061,
41333062,	41333725,	41333763,	41333806,	41334191,	41334192,	41334222,	41334223,	41334378,	41334409,	41334870,	41334897,	41335042,	41335051,	41335082,	41335560,	41335774,	41335808,	41336234,	41336235,
41336418,	41336891,	41337080,	41337118,	41337353,	41337367,	41337773,	41337998,	41338164,	41338317,	41338428,	41338696,	41338697,	41338991,	41339505,	41339578,	41339895,	41339944,	41340177,	41340669,
41340841,	41340948,	41341433,	41341470,	41341693,	41342396,	41342397,	41342398,	41342514,	41342516,	41342559,	41342560,	41342568,	41342684,	41342752,	41342769,	41342770,	41342948,	41343088,	41343433,
41343821,	41343822,	41344072,	41344227,	41344228,	41344810,	41345040,	41345198,	41345313,	41345314,	41345412,	41345674,	41345675,	41345712,	41345841,	41345842,	41345843,	41345844,	41345845,	41345909,
41346433,	41350618,	41350696,	41350826,	41350958,	41351126,	41351127,	41351198,	41351216,	41351256,	41351340,	41351412,	41351413,	41351522,	41351589,	41384989,	41385717,	41387037,	41388366,	41389105,
41453986,	41455507,	41457516,	41459010,	41459850,	41460785,	41460987,	41461359,	42629017,	42629018,	42629020,	42705177,	42705230,	42705234,	42705245,	42705263,	42705264,	42705423,	42706068,	42706069,
42706151,	42706597,	42706599,	42706603,	42706771,	42706772,	42706818,	42706820,	42706833,	42706834,	42706835,	42706836,	42707571,	42707572,	42707634,	42708735,	42708736,	42708926,	42708927,	42799483,
42799746,	42799748,	42799766,	42800104,	42800105,	42800108,	42800109,	42800111,	42800112,	42800171,	42800172,	42800179,	42800180,	42800181,	42800182,	42800183,	42800185,	42800191,	42800192,	42800193,
42800194,	42800218,	42800224,	42800225,	42800727,	42873418,	42873420,	42873421,	42873422,	42873423,	42873627,	42873628,	42873629,	42873630,	42873631,	42873632,	42900501,	42901119,	42901134,	42901348,
42901349,	42901433,	42901434,	42901435,	42901437,	42901439,	42901440,	42901442,	42901444,	42901445,	42901473,	42901474,	42901475,	42901476,	42901480,	42901550,	42901997,	42901998,	42902102,	42902107,
42902108,	42902110,	42902111,	42902114,	42902115,	42902158,	42902440,	42903031,	42903212,	43011452,	43011453,	43011454,	43013495,	43013498,	43013655,	43013658,	43013659,	43013666,	43013737,	43014077,
43014080,	43014086,	43014089,	43014090,	43014093,	43134958,	43135450,	43135454,	43135455,	43135456,	43141351,	43146328,	43146329,	43146330,	43148942,	43148943,	43148944,	43152443,	43154061,	43157087,
43157291,	43157577,	43157578,	43157579,	43158931,	43160150,	43168162,	43169801,	43171059,	43171060,	43174553,	43179035,	43179535,	43182052,	43185408,	43185409,	43185410,	43190434,	43198011,	43201183,
43201184,	43201490,	43204053,	43207307,	43207308,	43211786,	43211787,	43211788,	43211978,	43211979,	43213647,	43218310,	43218311,	43219875,	43219876,	43219877,	43255982,	43256485,	43256486,	43256487,
43257278,	43258713,	43260752,	43262688,	43264151,	43264166,	43266787,	43267296,	43268146,	43268147,	43269634,	43271708,	43271749,	43271750,	43272792,	43273660,	43275174,	43278270,	43280480,	43284462,
43284464,	43288537,	43289858,	43289859,	43289860,	43293415,	43295291,	43295293,	43295294,	43296751,	43525625,	43526085,	43526086,	43526087,	43526117,	43526118,	43526122,	43526125,	43526130,	43526131,
43526132,	43526133,	43526134,	43526135,	43526136,	43526137,	43526138,	43526139,	43526140,	43526141,	43526142,	43526143,	43526144,	43526145,	43526146,	43526394,	43526414,	43526415,	43526416,	43526417,
43526418,	43526419,	43526420,	43526421,	43526422,	43526423,	43531746,	43532628,	43560048,	43560721,	43560724,	43582147,	43582411,	43582412,	43582413,	43582421,	43584168,	43584171,	43600172,	43600173,
43600178,	43600449,	43600454,	43600466,	43600467,	43600468,	43600477,	43600478,	43602199,	43602200,	43602203,	43602204,	43611474,	43620191,	43627251,	43636294,	43636592,	43636595,	43636599,	43636600,
43638304,	43638305,	43638306,	43645394,	43654337,	43654630,	43654649,	43654651,	43654655,	43654656,	43654657,	43656429,	43656430,	43658486,	43661832,	43663548,	43665157,	43672763,	43672764,	43672768,
43672769,	43672770,	43672771,	43672772,	43672773,	43674558,	43674559,	43676556,	43683656,	43690612,	43690613,	43690616,	43691874,	43694362,	43701070,	43701694,	43701695,	43708482,	43708483,	43708484,
43708486,	43708487,	43708488,	43708491,	43710172,	43710174,	43710175,	43726125,	43726414,	43726416,	43726417,	43730212,	43735367,	43739423,	43746119,	43748133,	43755476,	43762049,	43762054,	43762320,
43762331,	43762332,	43764027,	43764028,	43764029,	43764030,	43766111,	43771203,	43780121,	43780406,	43780420,	43782170,	43787422,	43791277,	43793204,	43798084,	43798085,	43798364,	43798368,	43798369,
43798374,	43800057,	43802658,	43816413,	43816414,	43816418,	43816419,	43818169,	43820253,	43829332,	43834617,	43834625,	43834626,	43834629,	43834630,	43834632,	43836347,	43836349,	43843369,	43844951,
43852578,	43852580,	43854282,	44034851,	44034852,	44035264,	44037928,	44050994,	44060943,	44062629,	44064008,	44064010,	44064631,	44064644,	44072828,	44076142,	44076707,	44089590,	44099637,	44101651,
44102683,	44112414,	44114493,	44116094,	44125584,	44126000,	44128016,	44128589,	44130319,	44130388,	44130389,	44130609,	44130990,	44131112,	44131574,	44131635,	44159802,	44165136,	44165137,	44173954,
44174817,	44175033,	44178788,	44178789,	44182292,	44189014,	44189368,	44190150,	44190527,	44506395,	44506401,	44507503,	44507749,	44507847,	44784836,	44784837,	44814308,	44814574,	44815777,	44815778,
44815779,	44815940,	44815941,	44815983,	44816050,	44816139,	44816140,	44816141,	44818062,	44818083,	44818386,	44818404,	45774573,	45774728,	45774730,	45774913,	45774914,	45774915,	45774916,	45775359,
45775905,	45775910,	45775911,	45776281,	45776286,	45776377,	45776437,	45776439,	45776441,	45776443,	45776580,	45776582,	45776611,	45776615,	45776722,	45776727,	45892270,	45892271,	45892389,	45892424,
46221359,	46221360,	46233830,	46234379,	46234381,	749964,	903963,	904171,	904331,	904332,	904333,	904335,	904338,	904385,	904387,	904392,	904395,	904427,	904436,	904506,
904509,	920458,	920595,	920596,	920597,	920598,	920625,	920626,	920627,	920665,	920669,	920712,	920713,	920716,	920717,	920718,	920755,	920757,	920796,	920797,
920798,	920799,	920800,	920823,	920824,	920825,	920826,	920827,	920828,	920829,	920831,	920862,	920868,	920869,	920870,	920871,	920915,	920916,	920917,	920918,
920944,	920945,	920946,	920947,	975125,	975168,	975169,	975193,	975504,	975505,	975588,	975644,	975926,	975928,	975929,	975931,	975952,	975953,	975954,	975955,
975982,	975984,	975985,	975986,	976014,	976015,	976016,	976017,	976077,	977421)


/*************************************************************************************************************
Section 3
Question: "For patients with covid-19 related hospitalizations, what is the mortality rate by use of 
	steroid immuosuppresant & mortality, stratified by age group/gender/ethnicity/race?"
*************************************************************************************************************/

-- Create full set of permissible concepts  (gender, race, ethnicity, age-range)
	if object_id('tempdb.dbo.#gender') is not null drop table #gender  
	select concept_id covariate_id, domain_id covariate_name, concept_name covariate_value 
	into #gender from @vocab_schema.CONCEPT 
	where domain_id = 'Gender' and standard_concept = 'S' 
	union 
	select 0, 'Gender', 'Unknown'; 

	if object_id('tempdb.dbo.#race') is not null drop table #race  
	select concept_id covariate_id, domain_id covariate_name, concept_name covariate_value  
	into #race from @vocab_schema.CONCEPT 
	where domain_id = 'race' and standard_concept = 'S' 
	and concept_code  in ('1','2','3','4','5')
	union 
	select 0, 'Race', 'Unknown'; 
	
	if object_id('tempdb.dbo.#ethnicity') is not null drop table #ethnicity  
	select concept_id covariate_id, domain_id covariate_name, concept_name covariate_value  
	into #ethnicity from @vocab_schema.CONCEPT 
	where domain_id = 'ethnicity' and standard_concept = 'S' 
	union 
	select 0, 'Ethnicity', 'Unknown';

	if object_id('tempdb.dbo.#age_range') is not null drop table #age_range  
	select 1 covariate_id, 'Age_Range' covariate_name, '[18 - 30]' covariate_value into #age_range  union 
	select 2, 'Age_Range', '[31 - 40]' union 
	select 3, 'Age_Range', '[41 - 50]' union 
	select 4, 'Age_Range', '[51 - 60]' union 
	select 5, 'Age_Range', '[61 - 70]' union 
	select 6, 'Age_Range', '[71 - 80]' union 
	select 7, 'Age_Range', '[81 - ]' union
	select 8, 'Age_Range', 'Unknown'; 


-- Glucocorticoid Meds
	if object_id('tempdb.dbo.#gluco_medications') is  not null drop table #gluco_medications 
	select distinct *
	into #gluco_medications from (
	select cp.person_id, cp.visit_occurrence_id, cp.visit_concept_id, cp.visit_start_datetime, cp.visit_end_datetime
	, cp.AgeAtVisit, cp.cohort_start_date, cp.death_datetime, cp.Hospital_mortality, vd.drug_exposure_start_datetime
	from #covid_hsp cp 
	join @cdm_schema.drug_exposure vd on  cp.person_id = vd.person_id 
	join #glucocorticoid mv on mv.concept_id = vd.drug_concept_id
	where datediff(dd, vd.drug_exposure_start_date, cp.visit_start_datetime) between 0 and  365
	) a;

--COVID patients with the 4 exposure variables
if object_id('tempdb.dbo.#patients') is  not null drop table #patients
select distinct hsp.visit_occurrence_id, hsp.person_id, hsp.visit_concept_id, hsp.visit_start_datetime, hsp.visit_end_datetime
    , hsp.discharge_to_concept_id 
	, disch_disp.concept_name Discharge_disposition
	, case when glucm.person_id is not null then 1 else 0 end as Exposure_Variable_id
	, hsp.Hospital_mortality as Outcome_id
	, case when gender.covariate_id is null then 0 else p.gender_concept_id end gender_concept_id 
	, case when race.covariate_id is null then 0 else p.race_concept_id end race_concept_id 
	, case when ethnicity.covariate_id is null then 0 else p.ethnicity_concept_id end ethnicity_concept_id 
	, case when round(hsp.AgeAtVisit ,2) between 18 and 30 then 1
			when round(hsp.AgeAtVisit ,2) between 31 and 40 then 2
			when round(hsp.AgeAtVisit ,2) between 41 and 50 then 3
			when round(hsp.AgeAtVisit ,2) between 51 and 60 then 4
			when round(hsp.AgeAtVisit ,2) between 61 and 70 then 5
			when round(hsp.AgeAtVisit ,2) between 71 and 80 then 6
			when round(hsp.AgeAtVisit ,2) > 80 then 7
		else 8 end as age_id
into #patients
from #covid_hsp hsp
left join #gluco_medications glucm on glucm.person_id = hsp.person_id 
left join @cdm_schema.person p on p.person_id = hsp.person_id
left join @vocab_schema.concept disch_disp on disch_disp.concept_id =  hsp.discharge_to_concept_id
left join #gender gender on gender.covariate_id = p.gender_concept_id
left join #race race on race.covariate_id = p.race_concept_id
left join #ethnicity ethnicity on ethnicity.covariate_id = p.ethnicity_concept_id;

/**************************************************************************************************
Section 4:			Results
**************************************************************************************************/

--Section A: Results setup
if object_id('tempdb.dbo.#Exposure_variable') is not null drop table #Exposure_variable
select 0 [Exposure_variable_id], 'Glucocorticoid_medications' [Exposure_variable_name], 'no' [Exposure_variable_value]
into #Exposure_variable
union
select 1, 'Glucocorticoid_medications', 'yes'
;

if object_id('tempdb.dbo.#Outcome') is not null drop table #Outcome
select 0 outcome_id, 'Hospital_Mortality' outcome_name, 'discharged_alive' outcome_value
into #Outcome
union
select 1, 'Hospital_Mortality' , 'deceased_during_hospitalization';


--Results (Glucocorticoid_medications)
--Gender
	select '@sitename' Institution
	, m.covariate_name 
	, m.covariate_value 
	, m.Exposure_variable_name
	, m.Exposure_variable_value 
	, m.outcome_name Outcome_name
	, m.outcome_value Outcome_value
	, count(distinct visit_occurrence_id) EncounterCount
	, count(distinct person_id) PatientCount
	, @version Query_Version
	, @queryExecutionDate Query_Execution_Date
	into #results
from (select * from  #gender
		cross join  (select * from #Exposure_variable where Exposure_variable_name ='Glucocorticoid_medications')a
		cross join #outcome
	) m
left join #patients p on m.Exposure_variable_id = p.Exposure_Variable_id
	and m.outcome_id = p.Outcome_id
	and m.covariate_id = p.gender_concept_id
group by m.covariate_name, m.covariate_value, m.Exposure_variable_name, m.Exposure_variable_value, m.outcome_name, m.outcome_value

union

--race
	select '@sitename' Institution
	, m.covariate_name 
	, m.covariate_value 
	, m.Exposure_variable_name
	, m.Exposure_variable_value 
	, m.outcome_name Outcome_name
	, m.outcome_value Outcome_value
	, count(distinct visit_occurrence_id) EncounterCount
	, count(distinct person_id) PatientCount
	, @version Query_Version
	, @queryExecutionDate Query_Execution_Date
from (select * from  #race
		cross join  (select * from #Exposure_variable where Exposure_variable_name ='Glucocorticoid_medications')a
		cross join #outcome
	) m
left join #patients p on m.Exposure_variable_id = p.Exposure_Variable_id
	and m.outcome_id = p.Outcome_id
	and m.covariate_id = p.race_concept_id
group by m.covariate_name, m.covariate_value, m.Exposure_variable_name, m.Exposure_variable_value, m.outcome_name, m.outcome_value

union

--ethnicity
	select '@sitename' Institution
	, m.covariate_name 
	, m.covariate_value 
	, m.Exposure_variable_name
	, m.Exposure_variable_value 
	, m.outcome_name Outcome_name
	, m.outcome_value Outcome_value
	, count(distinct visit_occurrence_id) EncounterCount
	, count(distinct person_id) PatientCount
	, @version Query_Version
	, @queryExecutionDate Query_Execution_Date
from (select * from  #ethnicity
		cross join  (select * from #Exposure_variable where Exposure_variable_name ='Glucocorticoid_medications')a
		cross join #outcome
	) m
left join #patients p on m.Exposure_variable_id = p.Exposure_Variable_id
	and m.outcome_id = p.Outcome_id
	and m.covariate_id = p.ethnicity_concept_id
group by m.covariate_name, m.covariate_value, m.Exposure_variable_name, m.Exposure_variable_value, m.outcome_name, m.outcome_value

union

--age range
	select '@sitename' Institution
	, m.covariate_name 
	, m.covariate_value 
	, m.Exposure_variable_name
	, m.Exposure_variable_value 
	, m.outcome_name Outcome_name
	, m.outcome_value Outcome_value
	, count(distinct visit_occurrence_id) EncounterCount
	, count(distinct person_id) PatientCount
	, @version Query_Version
	, @queryExecutionDate Query_Execution_Date
from (select * from  #age_range
		cross join  (select * from #Exposure_variable where Exposure_variable_name ='Glucocorticoid_medications')a
		cross join #outcome
	) m
left join #patients p on m.Exposure_variable_id = p.Exposure_Variable_id
	and m.outcome_id = p.Outcome_id
	and m.covariate_id = p.age_id
group by m.covariate_name, m.covariate_value, m.Exposure_variable_name, m.Exposure_variable_value, m.outcome_name, m.outcome_value
order by Exposure_variable_name, covariate_name, covariate_value, Exposure_variable_value,  Outcome_Name, Outcome_Value;

	select Institution, covariate_name, covariate_value, Exposure_variable_name, Exposure_variable_value, Outcome_name, Outcome_value
	, case when @minAllowedCellCount = 0 then try_convert(varchar(20), EncounterCount)
			when @minAllowedCellCount = 11 and EncounterCount between 1 and 10 then '[1-10]' 
			when @minAllowedCellCount = 11 and EncounterCount = 0 or EncounterCount >=11 then  try_convert(varchar(20), EncounterCount)
			end as EncounterCount
	, case when @minAllowedCellCount = 0 then try_convert(varchar(20), PatientCount)
			when @minAllowedCellCount = 11 and PatientCount between 1 and 10 then '[1-10]' 
			when @minAllowedCellCount = 11 and PatientCount = 0 or PatientCount >=11 then  try_convert(varchar(20), PatientCount)			
			end as PatientCount
	, Query_Version
	, Query_Execution_Date
	from #results;
