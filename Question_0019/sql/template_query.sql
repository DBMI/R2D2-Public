/************************************************************************************************************
Project:	R2D2
Create date: 07/16/2020
Question number: Question_0019
Question in Text: "For patients with covid-19 related hospitalizations, what is the mortality rate by use of 
	steroid immuosuppresant & mortality, stratified by age group/gender/ethnicity/race?"

Database: SQL Server

Author name: Rob Follett
Author GitHub username: rfollett
Author email: rfollett@mednet.ucla.edu
Version : 3.1

Last modified date: 08/11/2020 - Using new hospitalization logic from Q000


Instructions: 
-------------

Initialize variables: 
	i) Please change the site number of your site
	ii) Please change threshold for minimum counts to be displayed in the results. Possible values are 0 or 11.
	Default value is 0 (ie no cell suppression). When value is 11, result cell will display [1-10].


Section 1: Create a base cohort

Section 2: Prepare concept sets

Section 3: Design a main body
	
Section 4: Report in a tabular format


Updates in this version:
-------------------------
1) Used R2D2 COVID-19 concept sets and hospitalization definition instead of local institutional definition
2) Removed [0-17] age category
3) Added an additional column 'Outcome_name' to display the outcome name
4) All demographic categories are displayed in the results even if counts are 0
5) Added result cell suppression logic

*************************************************************************************************************/
USE OMOP
GO

/*********************** do not update *****************/
declare @version numeric(2,1) = 3.1;
declare @queryExecutionDate datetime = (select getdate());
/********************************************************/

/************************************************************************************************************* 
	Site specific customization required (Please substitute local codes for Covid + patients 
**************************************************************************************************************/

--Initialize variables
	declare @sitename varchar(20) = 'Site08';
	declare @minAllowedCellCount int = 0;			--Threshold for minimum counts displayed in results. Possible values are 0 or 11

/************************************************************************************************************* 
	Section 1: Get COVID hospitalizations using R2D2 concept sets 
**************************************************************************************************************/

drop table if exists #covid_hsp;
create table #covid_hsp (
		visit_occurrence_id bigint 
		, person_id bigint
		, visit_concept_id bigint
		, visit_start_datetime datetime
		, visit_end_datetime datetime
		, discharge_to_concept_id bigint
		, discharge_to_source_value varchar(256)
		, AgeAtVisit int
		, cohort_start_date datetime
		, days_bet_COVID_tst_hosp int
		, death_datetime datetime
		, Hospital_mortality int
		, rownum int
	);


insert into #covid_hsp (visit_occurrence_id, person_id, visit_concept_id, visit_start_datetime, visit_end_datetime
		, discharge_to_concept_id, discharge_to_source_value, AgeAtVisit,  cohort_start_date, days_bet_COVID_tst_hosp 
		, death_datetime, Hospital_mortality, rownum)
exec R2D2.sp_identify_hospitalization_encounters	--- gets COVID hospitalizations


/************************************************************************************************************* 
	Section 2: Concept sets specific to question (R2D2 Atlas)
**************************************************************************************************************/

/************************************************************************************************************* 
	Concept sets for glucocorticoids (R2D2 Atlas) Concept Set #788 and then filtered by Dr. Bell to remove
	terms for topical, inhaler, cream, paste, ophthalmic and pad.
	http://atlas-covid19.ohdsi.org/#/conceptset/788/details
**************************************************************************************************************/

	--  COVID-19 Atlas concept sets 
	if object_id('tempdb.dbo.#glucocorticoid') is not null drop table #glucocorticoid 

	select c.* 
	into #glucocorticoid
	from omop.dbo.concept c
	where concept_id in (
	40234093,	40234104,	920797,	40234071,	40173363,	19109470,	42800092,	1518643,	40234091,	40226641,	1518651,	40160929,	1551101,	40073533,	1150807,	40234024,
40049685,	42799751,	40234799,	40234073,	40234009,	44784837,	40239745,	40234028,	40227424,	920827,	40073530,	42706772,	40234034,	43526421,	916617,	19120572,
916209,	42706833,	40234054,	40052937,	976044,	40052987,	1518259,	1506472,	40052946,	19098185,	1551006,	43526145,	40234064,	40052956,	19104623,	19061952,
19118711,	40234738,	44507749,	43526137,	19063762,	42800176,	19081472,	19032638,	1550915,	19106650,	920796,	40085516,	19131465,	43526122,	40085177,	42873629,
19106202,	19121384,	40150051,	40234803,	40052939,	40052952,	1550716,	40028264,	1550720,	40052934,	19118280,	19056451,	920669,	19109978,	19109985,	40052954,
40154981,	40171296,	19083661,	1518683,	43526419,	43526118,	45776722,	43013655,	42901444,	19027190,	40234821,	40027152,	19122734,	40049722,	19007009,	1550951,
40160933,	975952,	19125543,	40227411,	43013737,	19040157,	40019105,	40226257,	1550652,	19120731,	42902166,	40228391,	975568,	19084826,	40085179,	19055347,
40226639,	19124218,	19076067,	19081630,	40173040,	975861,	904325,	42873420,	19090526,	40234721,	42800221,	19118696,	19033788,	19047753,	40073200,	19120584,
40231771,	40148540,	40233954,	19105430,	40028601,	19107560,	44814307,	43014080,	40073436,	40028260,	40234814,	19115592,	40226258,	40226548,	19088972,	904335,
1518745,	42902107,	19027188,	40052940,	40235895,	40073455,	45774579,	19091759,	40234049,	19116166,	19043372,	40049688,	19043347,	40167909,	19125245,	40110591,
19131603,	19021121,	45776286,	42873418,	40027149,	40027174,	19043508,	19027213,	40244439,	19115558,	19001446,	916464,	40049728,	42873631,	40233980,	19032802,
19047796,	1518642,	19129102,	19067794,	19078313,	42901434,	40085185,	19109973,	40093824,	40234090,	40234812,	40020792,	904333,	19056328,	40235163,	19024534,
1518606,	1518293,	19047824,	40085186,	40073196,	40073456,	19059580,	40228393,	40085198,	45774577,	1518689,	19088901,	40093826,	19040242,	19121385,	19059686,
42800181,	40235164,	40234811,	40234078,	19066525,	19133284,	19058719,	40234040,	42873630,	19032808,	40041493,	19053596,	42901119,	40026666,	43526125,	42800099,
19063883,	40234077,	19027215,	40073201,	42901445,	19048397,	40223870,	19032705,	1550946,	40233986,	43526085,	19106204,	40234722,	19067189,	19120586,	1551098,
19110256,	19119910,	40085508,	1518684,	40052957,	19032709,	920826,	40049725,	40027455,	1518491,	19043315,	42901437,	975505,	19067406,	19034328,	40049701,
1550779,	19083175,	19107310,	40233958,	40234790,	1518682,	19119988,	40052959,	40233973,	45776678,	1518607,	40085193,	920871,	40049741,	40233951,	19007061,
40243957,	43014090,	19105911,	19109490,	44507847,	42706603,	904509,	43526138,	1518647,	19116155,	40170093,	40073186,	40052988,	19064283,	40234742,	40234059,
42800104,	40022480,	1506478,	42800108,	40226537,	40225771,	42800096,	19106649,	19111617,	40234725,	40028598,	920915,	43526139,	42800093,	920946,	19040156,
1518686,	40170091,	42800179,	45775306,	19115786,	42705245,	40228089,	40226638,	19059688,	19125539,	40226562,	40234792,	1550717,	19104629,	40234063,	19048393,
42901433,	40073437,	19006967,	40048205,	40234043,	43526415,	40234744,	19002191,	40227427,	40018864,	1551197,	40234798,	40018870,	43526134,	19105450,	19110247,
40085501,	920868,	19118112,	19122782,	40019093,	920862,	40226628,	40073194,	19067730,	40173366,	19121383,	19091242,	1506477,	40234100,	45774914,	40234804,
40226539,	19034197,	19030001,	19114213,	1550949,	19083579,	19067757,	19006962,	40234284,	19074184,	40025390,	42800182,	40073465,	40234819,	42800224,	40073806,
40036260,	19111612,	19067226,	40239015,	920825,	1150865,	40234741,	40018165,	19067752,	42706599,	40234805,	19116158,	1551099,	19076097,	45776281,	19113763,
40234072,	42800173,	19002193,	43014086,	40027454,	40019104,	40226630,	40173027,	42800177,	19078350,	40022942,	40027150,	40233976,	40233991,	19131604,	40231770,
19111657,	19076145,	42902158,	19115785,	19061691,	40073532,	40093822,	40073185,	40234808,	40227423,	19019893,	42799746,	19091760,	43526087,	40226254,	42800094,
904332,	1551122,	40052999,	19070932,	40073466,	45776615,	19107561,	975929,	40036254,	1551195,	40226633,	975985,	40234715,	40237061,	19120574,	40227430,
19120585,	19109983,	19018084,	975503,	40073187,	19116165,	40233981,	19064249,	42800095,	40010224,	1550780,	40028259,	19098197,	40239009,	43526142,	40073463,
40028606,	40073810,	976016,	1507733,	40226255,	45892271,	19120864,	19109493,	40233948,	40168724,	920918,	19089061,	920716,	19006964,	19002192,	43013496,
40049733,	19086912,	19118103,	1551200,	19078058,	42800174,	19129477,	19113806,	40228302,	40233950,	42800225,	40184346,	920945,	40052941,	19067760,	40226246,
40139039,	1518690,	43526132,	1550980,	975931,	40227407,	1551045,	40234102,	1507736,	40244441,	19034647,	903963,	42800109,	19063117,	19043320,	19115586,
19072839,	975510,	1518872,	43526394,	40073468,	40234057,	40161098,	19113764,	43526422,	42873627,	19047826,	43526414,	40234813,	19007010,	1506426,	19067755,
19059726,	40234764,	40226561,	40155457,	40234074,	40028258,	40019103,	19043348,	40234027,	19031961,	40226563,	40239145,	40234065,	40234006,	923877,	40239148,
19105412,	46233830,	920947,	1150806,	19006573,	19034807,	19062371,	40234739,	44506395,	19116364,	40052955,	19120058,	920712,	920596,	40018869,	19061517,
19115787,	42873422,	975986,	19126208,	40018861,	40052943,	40234723,	19116164,	40026668,	40073204,	19033819,	19059754,	40052938,	19002166,	40241180,	19034648,
19118695,	42800727,	19088976,	19111644,	40233972,	40018167,	42706836,	40160934,	42902108,	19084816,	19061353,	19034804,	1518254,	40231772,	19090623,	40004837,
1507705,	904436,	40233974,	42901475,	904387,	19043287,	40073197,	1518715,	1506473,	42901997,	40234558,	1507706,	19034803,	42873421,	40019101,	40085175,
40146099,	19027187,	40234795,	19109976,	40049699,	1507707,	43526416,	42800107,	19111647,	45775359,	42705264,	40073193,	40227431,	19104630,	19055344,	40226631,
1550778,	40036255,	904385,	19059640,	40231134,	40225772,	40234068,	19089064,	40020791,	42800111,	40233946,	40225766,	19118716,	975583,	1551170,	40073192,
42902111,	42708365,	40234041,	1518292,	40028361,	43526144,	40073460,	1518527,	19112080,	19106694,	40231136,	40073203,	19017933,	19078371,	44815941,	916439,
42800097,	19067728,	40234082,	40073457,	19062373,	19090524,	40234801,	1550975,	40072752,	920625,	40160930,	975954,	40122521,	19009116,	40010223,	19055348,
19058668,	19089065,	19047754,	1551100,	19032807,	19076135,	19096275,	19027462,	19032708,	40226549,	19118111,	45774915,	42800175,	19109784,	19125545,	40028569,
19078293,	19075849,	19006540,	19111651,	40171269,	1518605,	43526117,	40073808,	42706835,	45776439,	40028866,	40227422,	19076095,	40234079,	43013498,	40234004,
19061622,	19032704,	40233983,	19032450,	40073188,	46221360,	40239008,	1550944,	19015780,	40233992,	40234823,	43560724,	19067754,	40234044,	42705230,	1150862,
19047760,	19009885,	40018168,	45775307,	19067155,	42800101,	19110249,	19120561,	19120885,	43013523,	19078088,	40228392,	19125227,	19118110,	19048399,	19114216,
42901440,	19080585,	19001447,	40234047,	40073189,	916467,	19019891,	40060701,	1550561,	42901476,	40227425,	19086911,	40060705,	40085505,	45774573,	40234060,
19040123,	19007005,	19020402,	40234794,	19092830,	904506,	40234021,	19115593,	19110973,	19110389,	45776612,	43013497,	19109489,	40018136,	40225769,	19110115,
1518747,	19101887,	40049703,	40135826,	19072648,	40070932,	40184255,	42800105,	19115784,	40018867,	19096439,	19043313,	40060702,	975621,	40073813,	19095716,
1518258,	19063881,	1551232,	40234023,	1518691,	920798,	19115543,	40004833,	920831,	40028575,	19081460,	40226634,	42800186,	19113720,	19101886,	40019102,
19085227,	40161097,	19120341,	45776727,	42706771,	43526086,	43014077,	916465,	19112480,	40237064,	42903031,	40226550,	43013659,	19118101,	40085503,	40227410,
40173039,	19117911,	42799766,	19032703,	40244442,	40167747,	43532629,	40233949,	1518644,	42708926,	19065985,	1506476,	19059753,	40226900,	19029017,	1551198,
19109979,	19006966,	40234099,	45776610,	19089062,	975928,	40052967,	45892425,	40234067,	40085188,	19074157,	42708927,	1550945,	40163010,	1551234,	40053001,
44814317,	19106652,	19043346,	19104123,	40018148,	19082976,	40226538,	40233987,	976015,	19040124,	40052935,	40234824,	44784836,	19079489,	19111626,	19028933,
45774728,	40174834,	19105525,	19059601,	19072791,	40241504,	19062372,	42901998,	40137835,	40137836,	19071438,	19105671,	19018083,	19110101,	19062987,	19095136,
19091192,	42901348,	19083125,	19097857,	19034205,	19108993,	45774916,	19080745,	40167746,	19095718,	40025389,	19061549,	19120845,	40153792,	40171267,	40226267,
19060706,	19029973,	19065036,	40020968,	40169495,	19061909,	19006572,	19100015,	19112502,	19120064,	40022326,	19089063,	19034645,	19061619,	19040967,	19054922,
19037464,	19019900,	19123117,	44816050,	40129759,	19106829,	19081860,	19129476,	19073361,	19114612,	45775910,	19105547,	19107654,	19039158,	42706153,	42705423,
43013495,	19082890,	19043285,	19122648,	44507503,	43532855,	19125771,	19061218,	40122522,	19085786,	19034806,	19122781,	40154682,	19118143,	40012593,	19117427,
19061357,	19061458,	19116365,	45776443,	19112260,	19085551,	19019158,	19060082,	42902255,	19095651,	19073018,	19034014,	19085082,	19058164,	19117813,	19124041,
44814574,	19106690,	42708366,	19101595,	42903212,	19107677,	19112078,	19064203,	19134690,	19032806,	19110248,	19021122,	19009120,	19103718,	19017527,	46234379,
45892421,	19058074,	19078054,	19109448,	44816139,	19053595,	19126169,	40130114,	43525625,	42902250,	19085371,	45774991,	40224101,	40170022,	19066846,	19101279,
40004832,	40026665,	19110325,	43560721,	40129765,	40243304,	19067793,	43013666,	19104122,	19107858,	19112486,	19075030,	40112721,	40241185,	19068157,	40168005,
40170023,	19084526,	19080591,	19118409,	19084229,	19055349,	44818386,	19078142,	40010078,	19081471,	19089451,	19070310,	40226714,	19118641,	40233165,	19043850,
19082977,	19041535,	40013687,	19050908,	19093653,	19059681,	19113790,	19104487,	19032378,	19129883,	19132464,	19118736,	19120348,	19063119,	19070931,	42901134,
45776729,	19019692,	19098918,	19131605,	19109240,	19074792,	19117024,	19022881,	40145462,	19061120,	19109114,	40017873,	40239444,	19033622,	19108490,	19016533,
19112198,	19085298,	19085031,	19085928,	19033841,	40054910,	19000845,	40243944,	43532892,	42902102,	19122159,	40102083,	40163406,	19064799,	19027628,	19127775,
40146416,	19132093,	19002013,	19003486,	19021571,	40103944,	19045957,	19098058,	19129069,	19075376,	19028399,	19078412,	42706069,	42707572,	19038300,	40109740,
19039383,	43011453,	19047317,	44818404,	19072499,	19117207,	46221727,	19121101,	19093396,	19123616,	40077887,	42901550,	40153101,	40030154,	19117916,	40163009,
19015801,	19076989,	19125148,	916466,	19105449,	40073811,	42706068,	40227406,	45776437,	40239443,	43526420,	42705177,	40234051,	19105447,	19059634,	40227414,
19048394,	40240653,	19027280,	975168,	19009119,	45892426,	19121519,	40233172,	1518646,	42901474,	19133287,	40122600,	904338,	40103943,	40174833,	920944,
19001448,	19006961,	40233952,	19018906,	40226564,	1550719,	19009117,	40234053,	43526130,	40028602,	40239016,	19119991,	40234061,	19118765,	19109794,	40028574,
920458,	40052950,	19118759,	40234069,	1551233,	19074770,	19019931,	1550560,	40052978,	45776611,	40041462,	45774730,	19078060,	42800171,	42708736,	40234094,
42706155,	40019091,	40184254,	40244451,	40234101,	904171,	40054909,	40234791,	40239007,	19093425,	975502,	19067751,	19125225,	904163,	40027148,	40049740,
40234029,	43526418,	19097852,	19032706,	40122520,	40036261,	40171270,	40049689,	42799752,	19034027,	19109391,	19034196,	42706818,	40227426,	40018149,	920665,
19120576,	19093724,	40048206,	904395,	19032803,	19122856,	40170092,	1551196,	19099970,	19003485,	1550950,	40018151,	42873632,	920800,	19032710,	19127835,
40060704,	42901439,	43011454,	19093625,	19063153,	19089452,	42800185,	19109386,	19067188,	40234818,	42800098,	40093829,	40234083,	19043371,	40085187,	40049691,
42800194,	40167745,	40049702,	42901480,	40234802,	1518751,	40028585,	1507735,	40018163,	19109785,	40163006,	19067190,	19052207,	40234050,	40046786,	42800172,
19052208,	40027462,	42800100,	1551046,	40093819,	19095811,	40085517,	1551044,	1550572,	1551008,	19029909,	19081625,	19061653,	19126788,	43014089,	904427,
43531746,	19032870,	19032809,	40122518,	40233953,	19129988,	40049690,	19098154,	40184256,	40052942,	19122656,	1551011,	40085506,	1518261,	40073458,	40052945,
42800187,	19114215,	975193,	40234008,	40049684,	976017,	1518742,	1551193,	42800218,	19019667,	19120349,	19043507,	40234815,	40234042,	40226268,	19120573,
19053476,	19096297,	19115163,	40234035,	40018161,	19090525,	1518609,	40226636,	40019090,	1550557,	19119992,	40073454,	19007006,	45776441,	19115555,	19043531,
19043349,	40234737,	40234080,	920713,	45774913,	40234075,	19112268,	40167744,	45774731,	19107660,	1518610,	40163407,	40025388,	40073190,	40049687,	40226547,
42800220,	19067555,	46221359,	40028586,	19101719,	19047727,	19039286,	40052933,	976014,	976108,	975926,	40052998,	19067729,	40231784,	40025524,	19007062,
19006940,	40073809,	19118100,	19115554,	40073191,	19115594,	976282,	40234038,	42799483,	1506312,	44814308,	1506516,	19105524,	40234048,	19095151,	40027461,
40234037,	40234025,	40173041,	19116163,	40234030,	975588,	40241505,	19047795,	40073807,	19061583,	40234032,	1550581,	19078086,	40049723,	40231783,	19109805,
40231133,	40171268,	42800188,	904130,	40234031,	19090523,	40233173,	40234033,	19117982,	19135618,	40226901,	19034204,	40227415,	40233947,	1507738,	40234716,
19032702,	40018863,	19022882,	920598,	19111643,	19088971,	19031962,	904392,	19076121,	19111614,	40234056,	40004834,	19034231,	19067759,	19110892,	40234816,
19059604,	1551004,	40163008,	40052947,	1551043,	44816141,	40225770,	920870,	40073195,	40052958,	19112511,	40019100,	1551171,	19116151,	19117428,	40234807,
19032573,	1518603,	19106203,	40233975,	19067795,	1518608,	40052996,	40060730,	19069346,	19103651,	40107134,	1193369,	19104309,	45892389,	749964,	19087452,
19091880,	19111975,	40230630,	19054212,	19083056,	19127696,	43532628,	19102510,	19022370,	19026063,	40055571,	19076982,	40154093,	1193334,	19120626,	19011127,
40243744,	19133827,	40135413,	19030008,	19126326,	19023479,	19110848,	42902440,	19108592,	19010087,	19121837,	19033379,	19070678,	19095813,	19113164,	19080181,
40127030,	40223687,	19097275,	19045921,	40173042,	19096935,	19088174,	19029656,	19052278,	19109288,	45776582,	19118291,	19064103,	19040080,	40147400,	19128780,
40149354,	1113120,	19025451,	19063892,	42708735,	40141448,	19115460,	19115461,	19114672,	19005824,	19073069,	21602728,	904331,	19050907,	42800110,	19067791,
19010639,	1550777,	1550943,	19118146,	19121075,	19060779,	40049704,	40073202,	45892270,	40027452,	40230690,	43526136,	40233170,	40228390,	43013658,	40004835,
40160931,	19120461,	1506315,	42800189,	40234720,	19072837,	40145460,	19059870,	40052949,	40173367,	40049692,	40022327,	19059685,	42706597,	19034012,	40085180,
1506479,	43532696,	19063927,	40049693,	43526141,	975504,	40234806,	42901442,	19102846,	19087453,	40055572,	40028607,	19067758,	19117914,	45776377,	19044143,
1518714,	19006965,	19061578,	43526423,	40153448,	19087429,	40234793,	19085840,	1193333,	42706156,	40228303,	19061654,	19109984,	19043374,	19111642,	40119172,
44815940,	19101991,	19059610,	19006939,	42902110,	19080702,	19061618,	19120587,	19122719,	40145461,	19007003,	975982,	40028360,	40146415,	19007007,	40228301,
19117981,	19043290,	40240652,	42800106,	19063870,	40018866,	42900501,	40018860,	19108994,	19034203,	40234092,	920755,	19007004,	19032804,	40234058,	1506576,
40060699,	19043317,	19067727,	1518687,	920718,	42705234,	40243943,	40122519,	40073198,	40241179,	19133538,	19061119,	19002139,	19118144,	920626,	45774729,
40233971,	40163007,	40028359,	19109001,	40239014,	920823,	40085504,	19063849,	40234005,	920824,	1193335,	19108479,	19002138,	19105452,	40241506,	19120343,
19106693,	42800190,	19120353,	40234007,	40167743,	45892424,	19115591,	40244440,	40073462,	19006571,	920869,	920829,	40223221,	42902114,	19043289,	40107135,
1507711,	19019892,	975584,	19080569,	40073812,	19067756,	1506270,	1518645,	42706820,	1551123,	40073529,	19120583,	19024533,	40028865,	44815777,	975644,
19050910,	40028584,	19108990,	40027453,	44818083,	19132476,	19120843,	40070931,	40233988,	1550916,	19050909,	19034650,	40234022,	920799,	1518685,	19027214,
19078115,	19067792,	19123032,	42800191,	19078343,	40085197,	40234809,	19110847,	19057671,	1550654,	19115584,	19055350,	40234810,	19043532,	19048398,	40028599,
40236754,	1551093,	19105526,	40019099,	43526140,	19119989,	1551051,	1550775,	43560048,	1518611,	40241503,	40020793,	1518746,	40073438,	904131,	19117918,
19116153,	19087427,	43526146,	1518525,	19056330,	42873628,	916619,	19034646,	44815778,	19076917,	975984,	45776728,	42800183,	40226266,	45775911,	19067753,
40073459,	19076149,	920757,	40234052,	42873423,	19105451,	40018868,	40012458,	19035282,	19052715,	19105809,	19052580,	19084372,	44815983,	19111173,	19110032,
40136334,	19095559,	40066473,	19118446,	19071469,	19084748,	19093831,	19115026,	19105393,	19104491,	19083989,	19095979,	19062690,	19016867,	19132463,	19075828,
1550917,	40234097,	42799753,	40243959,	19034805,	19116156,	19108992,	19118099,	40085176,	19047963,	40231132,	1506316,	19106651,	40226637,	19061580,	40234036,
40234796,	43526135,	1551042,	40234055,	40028362,	40230688,	19093712,	19110251,	40226541,	19120577,	40233985,	45776580,	19080565,	19093652,	19097091,	19086197,
44815779,	40226256,	19087451,	1194734,	40132835,	40060710,	976077,	975490,	40241184,	40122517,	40234076,	19095812,	975125,	19109290,	19034327,	19031623,
1518523,	19114037,	1506430,	1518604,	1506513,	19061907,	43011452,	42901473,	19056414,	43526417,	1178729,	19033380,	19108591,	1506520,	19120588,	19042519,
19052279,	19111649,	19106692,	40060728,	19077782,	19074763,	1550948,	19078141,	42705263,	40085182,	975955,	40234062,	19034011,	19003483,	19059755,	40115560,
40071907,	19087455,	40018160,	19087454,	40044443,	40234797,	19124219,	19027186,	1551199,	19105407,	40073199,	42706151,	40155295,	19061358,	19084373,	42707571,
1550947,	19118108,	19080005,	975953,	19116457,	19128896,	19108506,	40095885,	40234039,	40085519,	19081627,	975491,	40028577,	45775905,	40240462,	40241221,
19130001,	19109974,	1506474,	19086249,	40028604,	40234066,	40234081,	42902115,	1550918,	19128781,	19026064,	19027189,	40239006,	19107818,	19039743,	19084825,
19116152,	40028561,	45892422,	1551010,	1507737,	19007008,	19074185,	45776616,	40234817,	40049686,	19109387,	19129772,	1506314,	40233970,	40226640,	40234724,
19118090,	19089054,	19113791,	975169,	19119990,	19043316,	40167748,	19072647,	40026667,	19077946,	19116157,	19052473,	19131602,	40234820,	1507734,	19034013,
40001300,	19064110,	920828,	40059478,	40018865,	40234745,	19121838,	40233984,	19111650,	19030005,	19114673,	19006963,	42800193,	19052272,	40028266,	19078111,
19077020,	43013528,	920916,	1146889,	19006938,	40112724,	19029657,	40234800,	19076136,	19079404,	1507732,	19003484,	40027151,	920595,	44818062,	40231769,
1518851,	40240656,	19082564,	19109975,	42901349,	40022479,	43526131,	1518257,	40143203,	920627,	44816140,	19050941,	1506475,	42901435,	19130000,	40171266,
19048691,	40052977,	40085194,	19120837,	19117921,	40149642,	19100321,	40232617,	40228300,	977421,	920597,	19108508,	19063670,	19034021,	45774578,	40226649,
40226713,	19116154,	1551201,	40233959,	40049698,	40049700,	40073531,	19114227,	19079481,	40234726,	19019894,	40028600,	40231785,	40226642,	40234095,	40234743,
40049721,	19034232,	19127774,	45774989,	42800178,	40234098,	19107562,	19062573,	40226565,	19120824,	40226265,	42800112,	43526143,	40143531,	19083176,	40234740,
19034029,	40234822,	1550919,	19063770,	19029659,	40052944,	19095717,	44506401,	40234096,	1551007,	42800192,	40004836,	42799748,	19070679,	19098198,	1193340,
40226632,	40234825,	19101885,	40049729,	920917,	19022929,	43526133,	40073467,	19105515,	19016866,	19113805,	19002140,	19002161,	40233982,	19032707,	1551192,
43014093,	19061425,	19120000,	19125226,	46234381,	46221726,	19043318,	19078084,	40160932,	40234026,	914611,	19082356,	19053009,	927970,	19088731,	40097635,
19062339,	40073461,	40077886,	42800180,	42800086,	19118145,	40046782,	40052951,	40234070,	40077888,	19089689,	19030003,	40019092,	40235167,	19077950,	40052932,
42706834,	40052936,	19125246,	40233171,	19120004,	19006606,	40226643,	19118697,	19042857,	40073439,	40063869,	19132094,	19043509,	40085520,	19086888,	920717,
40234046,	19084817,	43532697,	916440,	19032805,	45774990,	19032449,	19047315,	40226635,	40234045,	19118761,	19105448,	1592239,	1592240,	1592241,	1592242,
1592243,	1592244,	1592245,	1592246,	1592247,	1592248,	1592249,	1592250,	1592251,	1592252,	1592253,	1592254,	1592255,	1592256,	1592257,	1592258,
1592259,	1592260,	1592261,	19129398,	19131653,	19133854,	21021050,	21021096,	21021097,	21021098,	21021099,	21021100,	21021102,	21021103,	21021104,	21021105,
21021110,	21021111,	21021112,	21021113,	21021115,	21021117,	21021120,	21021121,	21021125,	21021128,	21022439,	21022442,	21022443,	21022445,	21094864,	21094863,
21094862,	21094850,	21094849,	21094848,	21094847,	21091045,	21091044,	21091043,	21091042,	21091041,	21058369,	21058368,	21058268,	21058267,	21057909,	21057548,
21057547,	21057418,	21057417,	21057415,	21057413,	21055588,	21055583,	21055575,	21055573,	21055572,	21055570,	21050480,	21050475,	21050471,	21050470,	21050469,
21050468,	21050467,	21050466,	21050465,	21050464,	21050461,	21050459,	21050458,	21050457,	21050456,	21050439,	21050438,	21050393,	21049667,	21049605,	21048634,
21048437,	21048436,	21048396,	21048341,	21048340,	21048130,	21048121,	21047747,	21047745,	21045811,	21045810,	21045809,	21045808,	21045803,	21045802,	21045801,
21045747,	21045746,	21042133,	21042130,	21042129,	21042128,	21042124,	21040716,	21040715,	21040714,	21040713,	21040712,	21040711,	21040710,	21040709,	21040708,
21040707,	21040706,	21040705,	21040702,	21040701,	21040700,	21040699,	21040698,	21040697,	21040673,	21040643,	21039468,	21038538,	21038537,	21038514,	21038295,
21038294,	21038293,	21038287,	21037921,	21037917,	21037916,	21037915,	21037914,	21037913,	21037786,	21037782,	21035963,	21035962,	21035960,	21035955,	21035896,
21035895,	21032187,	21032184,	21032180,	21032179,	21032178,	21032177,	21030831,	21030830,	21030829,	21030828,	21030827,	21030826,	21030824,	21030823,	21030822,
21030821,	21030820,	21030817,	21030816,	21030815,	21030814,	21030813,	21030800,	21030799,	21030768,	21030045,	21029961,	21028732,	21028709,	21028501,	21028499,
21028497,	21028496,	21028486,	21028113,	21028112,	21028108,	21028107,	21028105,	21027997,	21027992,	21027991,	21027990,	21027989,	21026183,	21026180,	21026179,
21026170,	21026165,	21026164,	21026104,	21026103,	21099589,	21099588,	21099587,	21099586,	21099585,	21099584,	21099580,	21099579,	21099578,	21099576,	21099575,
21099574,	21099573,	21099572,	21099571,	21099521,	21098772,	21098694,	21097606,	21097582,	21097581,	21097404,	21097387,	21097176,	21097156,	21097155,	21096788,
21096671,	21096670,	21096664,	21096663,	21099590,	21099591,	21099593,	21099594,	21099595,	21099596,	21099597,	21099603,	21099605,	21099612,	21100964,	21100966,
21089698,	21089696,	21089692,	21089691,	21089690,	21089689,	21089688,	21089687,	21089686,	21089682,	21089681,	21089680,	21089679,	21089678,	21089675,	21089674,
21089673,	21089672,	21089671,	21089670,	21089623,	21089622,	21088478,	21088477,	21087847,	21087584,	21087352,	21087348,	21087013,	21087012,	21087011,	21086904,
21086901,	21086900,	21085080,	21085078,	21085073,	21085004,	21081313,	21081312,	21081309,	21081307,	21081306,	21081305,	21079973,	21079972,	21079971,	21079970,
21079969,	21079968,	21079965,	21079964,	21079962,	21079961,	21079960,	21079959,	21079958,	21079957,	21079956,	21079955,	21079932,	21079931,	21079893,	21079170,
21078119,	21078107,	21078101,	21077939,	21077938,	21077832,	21077666,	21077665,	21077664,	21077648,	21077647,	21077646,	21077280,	21077279,	21077272,	21077153,
21075359,	21075356,	21075353,	21075347,	21075275,	21075274,	21075273,	21071601,	21071600,	21071599,	21071598,	21071597,	21071596,	21071595,	21070280,	21070278,
21070274,	21070273,	21070272,	21070271,	21070270,	21070269,	21070268,	21070267,	21070266,	21070265,	21070261,	21070260,	21070259,	21070258,	21070257,	21070256,
21070255,	21070254,	21070253,	21070252,	21070251,	21070250,	21070248,	21070247,	21070246,	21070245,	21070243,	21070242,	21070241,	21070223,	21070183,	21069345,
21068974,	21068306,	21068238,	21068211,	21068210,	21068127,	21068030,	21068029,	21068028,	21068027,	21067799,	21067781,	21067780,	21067387,	21067385,	21067384,
21067383,	21067381,	21067268,	21067264,	21067262,	21067261,	21065418,	21065417,	21065416,	21065413,	21065408,	21065407,	21065353,	21065352,	21061683,	21061679,
21061676,	21061674,	21602729,	21602730,	21602731,	21602732,	21602733,	21602734,	21602735,	21602736,	21602737,	21602738,	21602739,	21602740,	21602741,	21602742,
21602743,	21602744,	21061673,	21061672,	21061671,	21061670,	21061669,	21061668,	21061662,	21061661,	21061660,	21061659,	21061658,	21061657,	21061656,	21061655,
21060316,	21060311,	21060305,	21060304,	21060303,	21060300,	21060299,	21060298,	21060295,	21060294,	21060293,	21060292,	21060280,	21060279,	21060278,	21060277,
21060247,	21060246,	21059467,	21059044,	21100967,	21100968,	21100969,	21100970,	21100971,	21100972,	21100973,	21104727,	21104740,	21104741,	21104743,	21104744,
21106521,	21106522,	21106525,	21106626,	21106627,	21051871,	21051870,	21051868,	21051863,	21106629,	21107007,	21107249,	21107263,	21107264,	21107535,	21107539,
21109379,	21109429,	21109434,	21109436,	21109437,	21109438,	21109440,	21109442,	21109443,	21109444,	21109445,	21109446,	21109449,	21109452,	21048518,	21110799,
21110802,	21114520,	21114525,	21116290,	21116291,	21116401,	21116402,	21116741,	21116755,	21116756,	21116758,	21116759,	21117187,	21117206,	21118342,	21120468,
21120469,	21120474,	21120475,	21120476,	21148589,	21148646,	21148648,	21148649,	21148650,	21148651,	21148652,	21148653,	21148654,	21148655,	21148656,	21148657,
21148659,	21148660,	21148661,	21148662,	21148663,	21148669,	21148670,	21148672,	21150008,	21150009,	21150010,	21150011,	21150013,	21150014,	21150015,	21150018,
21150019,	21150020,	21153808,	21153881,	21153883,	21153884,	21153885,	21155687,	21155688,	21155690,	21155691,	21155810,	21155814,	21156215,	21156432,	21156450,
21156527,	21156722,	21156724,	21156728,	21157795,	21158589,	21158590,	21158591,	21158592,	21158593,	21158595,	21158596,	21158597,	21158598,	21158599,	21158600,
21158601,	21158602,	21158603,	21158604,	21158608,	21158610,	21158612,	21158613,	21158619,	21158621,	21158622,	21159966,	21159968,	21163619,	21163620,	21163684,
21163685,	21163689,	21163690,	21163691,	21163692,	21165500,	21165501,	21165502,	21165503,	21165505,	21165506,	21165616,	21165990,	21165991,	21165992,	21165994,
21166009,	21166010,	21166200,	21166201,	21166218,	21166260,	21166470,	21167582,	21167583,	21167584,	21168339,	21168340,	21168371,	21168389,	21168390,	21168393,
21168396,	21168397,	21168400,	21168401,	21168402,	21168403,	21168404,	21168407,	21168408,	21168409,	21168414,	21168415,	21168416,	21168417,	21168419,	21168421,
21169760,	21169761,	21169762,	21169763,	21169767,	21169768,	21169769,	21169771,	21169772,	21173454,	21173455,	21173456,	21173457,	21173458,	21173469,	21175217,
21175218,	21175334,	21175335,	21175337,	21176022,	21176069,	21176138,	21176167,	35761825,	35761826,	35761829,	35761830,	21117062,	21117063,	21117268,	21119059,
21119118,	21119119,	21119120,	21119122,	21119123,	21119129,	21119130,	21119131,	21119132,	21119133,	21119134,	21119135,	21119136,	21119137,	21119139,	21119141,
21119143,	21119144,	21124062,	21124124,	21124125,	21124132,	21124133,	21124134,	21124140,	21126126,	21126128,	21126129,	21126130,	21126512,	21126521,	21126720,
21126721,	21126742,	21126743,	21126827,	21126828,	21127001,	21127009,	21128879,	21128901,	21128902,	21128903,	21128904,	21128906,	21128907,	21128908,	21128909,
21128910,	21128912,	21128913,	21128914,	21128915,	21128916,	21128917,	21128918,	21128919,	21128920,	21128921,	21128925,	21128931,	21128932,	21130235,	21130236,
21130237,	21130238,	21130241,	21138806,	40927815,	40927820,	40927821,	40927824,	40927825,	21138809,	21138810,	21138811,	21138812,	21138813,	21138814,	21138815,
21138816,	21138817,	21138822,	21138823,	21138824,	21138825,	21138826,	21138827,	21140164,	21140169,	21140170,	21140171,	21140172,	21140173,	21140174,	21140177,
21140178,	21140180,	21140181,	21140182,	21143859,	21143923,	21143924,	21143930,	21143934,	21145718,	21145719,	21145720,	21145860,	21145861,	21145862,	21145865,
21145866,	21146243,	21146254,	21146255,	21146273,	21146473,	21146755,	36236720,	36236721,	40225702,	40225703,	40227495,	40233219,	40843453,	40843460,	40843462,
40843463,	40843464,	40843475,	40843476,	40843477,	21166401,	40872513,	40872514,	40872515,	40872516,	40872517,	40872544,	40874697,	40874698,	40874699,	40874703,
40874704,	40874705,	40874706,	40874707,	40874708,	40874709,	40884942,	40884943,	40884944,	40884945,	21173387,	21173388,	21173389,	40884946,	40884947,	40884948,
40884949,	40884954,	40884955,	40884956,	40884957,	40884958,	40884959,	40884960,	40884961,	21175732,	21175744,	40884962,	40885884,	40887050,	40887051,	21176250,
21176262,	35604729,	35604741,	35606531,	35606532,	35606533,	35606536,	35606537,	35606538,	35606540,	35606541,	35606542,	35606544,	35606545,	35606547,	35606548,
35606592,	35745111,	35745112,	35745114,	35745115,	35745116,	35745117,	35745118,	35745119,	35745782,	35746403,	35746404,	35746405,	35746406,	35749308,	35749310,
35749311,	35749312,	35749963,	35749964,	35750567,	35750568,	35752984,	35753473,	35753474,	35753475,	35753476,	35753477,	35754167,	35754791,	35754792,	35754793,
35757650,	35757652,	35757653,	35757654,	35758282,	35758283,	35758902,	35758903,	35758904,	40887117,	40887271,	40887272,	40887273,	35762488,	35763122,	35763614,
35765904,	35765905,	35765907,	35766596,	35767212,	35767213,	35767756,	40888042,	40888043,	40890657,	40890658,	21133943,	21134011,	21134019,	21134021,	21135873,
21135988,	21135989,	21136375,	21136382,	21136397,	21136630,	21136802,	21136831,	21137953,	21138776,	21138777,	21138778,	21138779,	21138799,	21138801,	21138802,
21138803,	21138804,	21138805,	40928076,	40929193,	40930143,	40930340,	40931194,	40931195,	40934701,	40934725,	40934733,	40934734,	40934736,	40934737,	40934738,
40934739,	40934740,	40934755,	40934756,	40935291,	40936901,	40936902,	40936903,	40936915,	40936916,	40936917,	40938635,	40938636,	40938651,	40941073,	40941074,
40941075,	40941336,	40947252,	40947260,	40947261,	36884729,	36889955,	36892649,	40947262,	40947263,	40947264,	40947265,	40822226,	40822869,	40823035,	40823097,
40824287,	40824398,	40825342,	40825955,	40826406,	40834501,	40834502,	40835202,	40837105,	40841316,	40841321,	40841326,	40841327,	40841329,	40841330,	40841331,
40841332,	40841831,	40841832,	40841833,	40947266,	40947267,	40947268,	40947269,	40948171,	40949294,	40949295,	40949303,	40845203,	40847597,	40847602,	40848027,
40849562,	40849563,	40849564,	40852465,	40852466,	40852470,	40852475,	40852476,	40852477,	40852482,	40852483,	40852484,	40852485,	40852486,	40852487,	40852488,
40852489,	40852490,	40852491,	40853714,	40853715,	40853716,	40853717,	40853718,	40853722,	40853723,	40853724,	40853725,	40853726,	40853727,	40853728,	40854568,
40854569,	40855733,	40855738,	40855863,	40856718,	40856719,	40857811,	40862764,	40865633,	40865634,	40865920,	40866340,	40866948,	40867951,	40872470,	40872471,
40872472,	40872478,	40872498,	40872499,	40872503,	40950177,	40951138,	40955045,	40955071,	40959099,	40959111,	40959398,	40959853,	40961639,	40962471,	40962472,
40965854,	40965855,	40965856,	40965857,	40965890,	40965892,	40965893,	40878695,	40878947,	40880787,	40883716,	40883726,	40883727,	40883728,	40883729,	40883739,
40883740,	40883741,	40883742,	40883743,	40883744,	40965894,	40965895,	40965896,	40965897,	40965919,	40965920,	40966453,	40966454,	40968026,	40968027,	40968028,
40968034,	40968035,	40968036,	40969685,	40969686,	40969704,	40972028,	40972029,	40972030,	40976969,	40976978,	40976979,	40976980,	40976981,	40976982,	40976991,
40976992,	40976993,	40976994,	40976995,	40976996,	40976997,	40976998,	40976999,	40977000,	40978235,	40978236,	40978237,	40978243,	40978244,	40978245,	40978246,
40978247,	40978248,	35769727,	35770221,	35770222,	35771554,	35771555,	35774481,	35774482,	35774483,	35776631,	35777483,	35786264,	35787386,	36211788,	36211789,
36212191,	36212192,	36212193,	36214941,	36214942,	36218739,	36218740,	36218741,	36220296,	36220297,	40896801,	40896802,	40896811,	40896823,	40897108,	40897109,
40897487,	40897488,	40897489,	40903487,	40903521,	40903522,	40903523,	40903524,	40903525,	40903526,	40903527,	40903545,	36220857,	36220858,	36220859,	36222256,
36222257,	40904042,	40905621,	40905634,	40905635,	40907295,	40909691,	40909695,	40909696,	40909697,	40909700,	40914647,	40914652,	40914653,	40914654,	40914655,
40914656,	40914662,	40914663,	40914664,	40914665,	40914666,	40914668,	40915853,	40915854,	40915855,	40915856,	40915857,	40915858,	40915859,	40915860,	40915861,
40915864,	40915865,	40915866,	40915867,	40915868,	40915869,	40915870,	40915871,	40916776,	40917954,	40917955,	40917956,	40917998,	40918936,	40927812,	40927813,
40927814,	41022680,	41023663,	41023669,	41023698,	41023968,	41023969,	41028233,	41028234,	41028235,	41028236,	41028253,	41028259,	41028260,	41028265,	41028266,
41028267,	41028268,	41028269,	41028270,	41028271,	41028281,	41028282,	41028283,	41028822,	41030380,	41030382,	41030384,	41030385,	41030386,	41030387,	41030388,
41030389,	40946024,	40946035,	40946036,	40946037,	40946038,	40946039,	40946041,	40946042,	40946043,	40946044,	40946045,	40947246,	40947250,	40947251,	41030397,
41030398,	41030399,	41032084,	41032119,	41034497,	41034501,	41034502,	41036475,	41039416,	41039417,	41039418,	41039425,	41039426,	41039427,	41039430,	41039431,
41039432,	41039433,	41039434,	41039436,	41040657,	41040658,	41040659,	41040665,	41040666,	41040667,	41040668,	41040669,	41041544,	41041545,	41042724,	41042732,
41042733,	41042784,	41046470,	41052849,	41052850,	41052851,	41052852,	41053297,	41053973,	41054910,	41055985,	41055986,	41059449,	41059467,	41059476,	41059478,
41059479,	41059480,	41059481,	41059482,	41059495,	41059496,	41059982,	41059983,	41059984,	41059985,	41061508,	41061513,	41061514,	41061515,	41061516,	41061518,
41061519,	41065616,	41065617,	41065618,	41065619,	41065620,	41070693,	41070704,	41070705,	41070713,	41070714,	41070715,	41070716,	41070717,	41070718,	41070719,
41070720,	41071919,	41071920,	41071921,	41071922,	41071926,	41071927,	41071928,	41071929,	41071930,	41071931,	41072808,	41072809,	41074063,	41074263,	41077752,
41077891,	41081278,	41093120,	41093121,	41093122,	41093123,	41093124,	41093125,	41093135,	41093136,	41094833,	41097605,	41097606,	40979100,	40979101,	40979102,
40979103,	40980292,	40980302,	40980486,	40981277,	40981278,	40983958,	40990625,	40991744,	40992701,	40997176,	40997195,	40997196,	40997197,	40997198,	40997201,
40997208,	40997209,	40997210,	40997211,	40997212,	40997213,	40997214,	40997234,	40997235,	40997236,	40997237,	40997238,	40997239,	40997240,	40999352,	40999358,
40999359,	40999360,	40999369,	40999370,	40999371,	40999372,	41000998,	41003381,	41003382,	41005428,	41008328,	41008339,	41008340,	41008341,	41008342,	41008352,
41008353,	41008354,	41008355,	41008356,	41008357,	41008358,	41009581,	41009582,	41009583,	41009584,	41009585,	41009586,	41009587,	41009591,	41009592,	41009593,
41009594,	41009595,	41009596,	41009597,	41009598,	41009599,	41011635,	41012566,	41012567,	41164812,	41164814,	41166055,	41166056,	41166057,	41166058,	41166059,
41166060,	41166061,	41166062,	41166063,	41166064,	41166069,	41166070,	41166071,	41166072,	41166957,	41166958,	41166959,	41166961,	41175057,	41177851,	41177865,
41178636,	41178642,	41180277,	41196146,	41196147,	41196154,	41196155,	41196156,	41196160,	41196161,	41196162,	41196163,	41197415,	41197416,	41197417,	41197418,
41197419,	41197420,	41197427,	41197428,	41197429,	41197430,	41197431,	41198300,	41198301,	41199684,	41200475,	41201425,	41203265,	41052519,	41052527,	41052531,
41052540,	41084115,	41084116,	41084132,	41084133,	41084855,	41084856,	41084860,	41085522,	41091033,	41091034,	41091035,	41091065,	41091072,	41091073,	41091074,
41091075,	41091088,	41091089,	41091576,	41091577,	41097167,	41097168,	41097240,	41099180,	41099181,	41099182,	41099183,	41102126,	41102127,	41102128,	41102135,
41102136,	41102137,	41102138,	41102139,	41102140,	41102141,	41103354,	41103355,	41103356,	41103362,	41103363,	41103364,	41103365,	41103366,	41103367,	41104285,
41104286,	41109170,	41112522,	41115357,	41115363,	41115364,	41115649,	41115650,	41116099,	41116100,	41116101,	41117722,	41117723,	41118746,	41122169,	41122189,
41122190,	41122191,	41122202,	41122203,	41122204,	41122205,	41122211,	41122212,	41122717,	41124296,	41124297,	41124305,	41124306,	41124307,	41128512,	41128513,
41133474,	41133475,	41133482,	41133485,	41133486,	41133491,	41133492,	41133493,	41133494,	41133495,	41133496,	41134794,	41134795,	41134796,	41134797,	41134798,
41134800,	41134801,	41134802,	41134803,	41135694,	41135695,	41135696,	41135697,	41135698,	41135699,	41135701,	41136913,	41136914,	41137102,	41137103,	41146896,
41146897,	41146898,	41146899,	41146900,	41146911,	41147173,	41147174,	41147609,	41147611,	41149177,	41149178,	41164800,	41164804,	41164809,	41164810,	41164811,
41021301,	41021302,	41021601,	41022030,	41022031,	41210054,	41210056,	41222190,	41222191,	41222195,	41234153,	41237411,	41247080,	41247081,	41247082,	41247107,
41247114,	41247115,	41247116,	41247117,	41247118,	41247134,	41247135,	41247656,	41249178,	41249179,	41249181,	41249182,	41249183,	41249190,	41249191,	41249192,
41249193,	41249195,	41255151,	41149500,	41153703,	41153704,	41153734,	41153735,	41153736,	41153743,	41153745,	41153746,	41153747,	41153748,	41153749,	41153765,
41153766,	41155859,	41155861,	41155862,	41155868,	41155869,	41155870,	41155871,	41160384,	41160385,	41222266,	41279999,	41186924,	41186925,	41186926,	41186937,
41186939,	41209360,	41209376,	41209377,	41209383,	41209657,	41209658,	41209659,	42707634,	41212671,	41216047,	41216048,	41216049,	41216074,	41216075,	41216082,
41216083,	41216084,	41216085,	41216086,	41216087,	41216088,	41216089,	41216103,	41216627,	41218177,	41218179,	41218180,	41218186,	41218187,	41218188,	41218189,
41227219,	41227226,	41227227,	41227228,	41227236,	41227237,	41227238,	41227239,	41227240,	41227241,	41228472,	41228473,	41228474,	41228475,	41228476,	41228477,
41228478,	41228485,	41228486,	41228487,	41228488,	41228489,	41229380,	41230580,	41230587,	41230588,	41230589,	41230590,	41231524,	41240320,	41240344,	41240345,
41240619,	41250844,	41253150,	41253151,	41253152,	41259296,	41259297,	41259298,	41259299,	41259300,	41259304,	41259305,	41259306,	41259307,	41259308,	41259309,
41260196,	41260197,	41261486,	41261487,	41262275,	41271177,	41271178,	41271191,	41271444,	41154269,	41157554,	41159941,	41159942,	41159943,	41159951,	41160199,
41161933,	41271858,	41271859,	41273500,	41273799,	41277910,	41277911,	41277912,	41277929,	41277930,	41277931,	41277932,	41277938,	41277942,	41277943,	41277944,
41277945,	41277946,	41277959,	41279987,	41279997,	41279998,	41284128,	41284144,	41284145,	41284146,	41284147,	41284148,	41284149,	41290389,	41290390,	41290391,
41290392,	41290393,	41290394,	41290395,	41290397,	41290398,	41290399,	41184728,	41184758,	41184759,	41184760,	41184761,	41184766,	41184768,	41184769,	41184770,
41184771,	41184772,	41184773,	41184774,	41184783,	41184784,	41191069,	41191084,	41191085,	41191527,	41193128,	41290400,	41290401,	41219844,	41224136,	41315393,
41315394,	41315395,	41315396,	41315401,	41342948,	41320467,	41320474,	41320476,	41320477,	41320478,	41320479,	41320480,	41320481,	41320482,	41320483,	41320484,
41320485,	41320486,	41320487,	41320488,	41328007,	41343433,	41345909,	41258018,	41258021,	41258022,	41258023,	41258024,	41258028,	41258029,	41258030,	41258031,
41267259,	41329695,	41329696,	41330165,	41331092,	41331290,	41331481,	41331497,	41331498,	41332160,	41333018,	41333060,	41333061,	41333062,	41333725,	41333763,
41271201,	41333806,	41334191,	41334192,	41334222,	41334223,	41334870,	41334897,	41335082,	41335560,	41335774,	41335808,	41336234,	41336235,	41336418,	41336891,
41337080,	41337998,	41338164,	41338991,	41339505,	41339578,	41346433,	41350696,	41351126,	41351127,	41351198,	41351216,	41351256,	41351340,	41351412,	41351413,
41351522,	41351589,	41384989,	41385717,	41387037,	41388366,	41389105,	41341470,	41342396,	41342397,	41342398,	41342514,	41342516,	41342684,	41342752,	41315379,
41342769,	41342770,	41338317,	41350618,	41350826,	41350958,	41340948,	41341433,	41341693,	41293442,	41302297,	41302298,	41302308,	41302313,	41303657,	41303659,
41304565,	41304566,	41304567,	41304568,	41304607,	41304890,	41309170,	41309171,	41309172,	41309173,	41309174,	41342559,	41342560,	43141351,	43154061,	43160150,
43171059,	41342568,	41224137,	41224138,	41224139,	43171060,	43179535,	43190434,	41309175,	41309193,	41309700,	41309701,	41309702,	41311328,	41311329,	41311333,
41311335,	41311336,	41311337,	41313064,	41313092,	41317493,	41317494,	41317495,	41317496,	41343088,	41321695,	41321704,	41321705,	41321707,	41321708,	41321709,
41322619,	41322620,	41323797,	41323798,	41323799,	41323809,	41323858,	41324807,	41324808,	41324809,	41324810,	41327538,	41327551,	41327718,	41327738,	41327772,
41328369,	41343821,	41343822,	41344072,	41344227,	41344228,	41344810,	41345040,	41345198,	41345313,	41345314,	41345412,	41345674,	41345675,	41345712,	41345841,
41345842,	41345843,	41345844,	41345845,	41328401,	41328402,	41328838,	41332324,	41332325,	41332444,	41334378,	41334409,	41335042,	41335051,	41337118,	41337353,
41337367,	41337773,	41338428,	41338696,	41338697,	41339895,	41339944,	41340177,	41340669,	43582147,	41340841,	41286170,	41286171,	41289145,	41289146,	41289148,
41289149,	41289150,	41291287,	41292455,	41292456,	41292463,	41292576,	41292627,	41302993,	41309158,	41309159,	41309162,	43134958,	43135450,	43135454,	43135455,
43135456,	43146328,	43146329,	43146330,	43148942,	43148943,	43148944,	43152443,	43157087,	43157291,	43157577,	43157578,	43157579,	43158931,	43168162,	43169801,
43174553,	43179035,	43182052,	43185408,	43185409,	43185410,	43264151,	43264166,	41332842,	41332843,	43818169,	43293415,	43829332,	44050994,	44060943,	44174817,
44062629,	44175033,	44178788,	44064008,	44064010,	44064631,	44064644,	44072828,	44076142,	44076707,	44089590,	44099637,	43295291,	44101651,	44102683,	44112414,
44114493,	44116094,	44125584,	43295293,	43295294,	43296751,	43582411,	43582412,	44128589,	43582413,	44178789,	44182292,	44189014,	43582421,	43584168,	43584171,
43602199,	43602200,	43602203,	43602204,	43611474,	43636294,	44130388,	44130389,	44130990,	44131112,	43701694,	43701695,	43218310,	43218311,	43257278,	43710172,
43710174,	43710175,	43764027,	43764028,	43764029,	43764030,	43771203,	44173954,	44189368,	41289135,	43201183,	43201184,	43762049,	43762054,	43272792,	43273660,
43280480,	43288537,	43289858,	43816413,	43289859,	43289860,	43816414,	43816418,	43816419,	43834617,	43834625,	43834626,	43834629,	43834630,	43834632,	43836347,
43836349,	43843369,	43844951,	43852578,	43852580,	43854282,	44034851,	44034852,	44037928,	44128016,	43620191,	43211978,	43211979,	43275174,	43600466,	43600467,
43600468,	43600477,	43600478,	43636592,	43636595,	43636599,	43636600,	43645394,	43690612,	43690613,	43690616,	44159802,	44165136,	44165137,	43780406,	43266787,
43267296,	43268146,	43268147,	43269634,	43278270,	43284462,	43284464,	43780420,	43791277,	43793204,	43798364,	43798368,	43798369,	43798374,	43800057,	43802658,
43820253,	44035264,	44130319,	43600172,	43600173,	43600178,	43600449,	43600454,	43627251,	44130609,	43665157,	43746119,	43755476,	43787422,	43638304,	43638305,
43638306,	43654337,	43654649,	43654651,	43654655,	43654656,	43654657,	43656429,	43656430,	43658486,	43661832,	43663548,	43674558,	43674559,	43676556,	44190150,
41453986,	41455507,	41457516,	41459010,	41459850,	43683656,	43691874,	43694362,	43701070,	44190527,	41460785,	41461359,	42629017,	42629018,	42629020,	44131574,
44131635,	43198011,	43201490,	43204053,	43207307,	43207308,	43211786,	43211787,	43211788,	43213647,	43219875,	43219876,	43708482,	43708483,	43708484,	43708486,
43708487,	43219877,	43255982,	43256485,	43256486,	43256487,	43258713,	43708488,	43708491,	43726125,	43726414,	43726416,	43726417,	43730212,	43735367,	43739423,
43748133,	43762320,	43260752,	43262688,	43762331,	43762332,	43766111,	43780121,	43271708,	43271749,	43271750,	43782170,	43798084,	43798085,	44126000,	43672763,
43672764,	43672768,	43672769,	43672770,	43672771,	43672772,	43672773,	43654630,	41460987)


/*************************************************************************************************************
Section 3
Question: "For patients with covid-19 related hospitalizations, what is the mortality rate by use of 
	steroid immuosuppresant & mortality, stratified by age group/gender/ethnicity/race?"
*************************************************************************************************************/
-- Create full set of permissible concepts  (gender, race, ethnicity, age-range)
	if object_id('tempdb.dbo.#gender') is not null drop table #gender  
	select concept_id covariate_id, domain_id covariate_name, concept_name covariate_value 
	into #gender from CONCEPT 
	where domain_id = 'Gender' and standard_concept = 'S' 
	union 
	select 0, 'Gender', 'Unknown' 

	if object_id('tempdb.dbo.#race') is not null drop table #race  
	select concept_id covariate_id, domain_id covariate_name, concept_name covariate_value  
	into #race from CONCEPT 
	where domain_id = 'race' and standard_concept = 'S' 
	and concept_code  in ('1','2','3','4','5')
	union 
	select 0, 'Race', 'Unknown' 
	
	if object_id('tempdb.dbo.#ethnicity') is not null drop table #ethnicity  
	select concept_id covariate_id, domain_id covariate_name, concept_name covariate_value  
	into #ethnicity from CONCEPT 
	where domain_id = 'ethnicity' and standard_concept = 'S' 
	union 
	select 0, 'Ethnicity', 'Unknown' 

	if object_id('tempdb.dbo.#age_range') is not null drop table #age_range  
	select 1 covariate_id, 'Age_Range' covariate_name, '[18 - 30]' covariate_value into #age_range  union 
	select 2, 'Age_Range', '[31 - 40]' union 
	select 3, 'Age_Range', '[41 - 50]' union 
	select 4, 'Age_Range', '[51 - 60]' union 
	select 5, 'Age_Range', '[61 - 70]' union 
	select 6, 'Age_Range', '[71 - 80]' union 
	select 7, 'Age_Range', '[81 - ]' union
	select 8, 'Age_Range', 'Unknown' 


-- Glucocorticoid Meds
	if object_id('tempdb.dbo.#gluco_medications') is  not null drop table #gluco_medications 
	select distinct *
	into #gluco_medications from (
	select cp.person_id, cp.visit_occurrence_id, cp.visit_concept_id, cp.visit_start_datetime, cp.visit_end_datetime
	, cp.AgeAtVisit, cp.cohort_start_date, cp.death_datetime, cp.Hospital_mortality, vd.drug_exposure_start_datetime
	from #covid_hsp cp 
	join omop.dbo.drug_exposure vd on  cp.person_id = vd.person_id 
	join #glucocorticoid mv on mv.concept_id = vd.drug_concept_id
	where datediff(dd, vd.drug_exposure_start_date, cp.visit_start_datetime) between 0 and  365
	) a;

--COVID patients with the 4 exposure variables
if object_id('tempdb.dbo.#patients') is  not null drop table #patients
select distinct hsp.visit_occurrence_id, hsp.person_id, hsp.visit_concept_id, hsp.visit_start_datetime, hsp.visit_end_datetime
	, hsp.discharge_to_concept_id 
	, disch_disp.concept_name Discharge_disposition
	, case when glucm.person_id is not null then 1 else 0 end as Exposure_Variable_id
	, hsp.Hospital_mortality as Outcome_id
	, case when gender.covariate_id is null then 0 else p.gender_concept_id end gender_concept_id 
	, case when race.covariate_id is null then 0 else p.race_concept_id end race_concept_id 
	, case when ethnicity.covariate_id is null then 0 else p.ethnicity_concept_id end ethnicity_concept_id 
	, case when round(hsp.AgeAtVisit ,2) between 18 and 30 then 1
			when round(hsp.AgeAtVisit ,2) between 31 and 40 then 2
			when round(hsp.AgeAtVisit ,2) between 41 and 50 then 3
			when round(hsp.AgeAtVisit ,2) between 51 and 60 then 4
			when round(hsp.AgeAtVisit ,2) between 61 and 70 then 5
			when round(hsp.AgeAtVisit ,2) between 71 and 80 then 6
			when round(hsp.AgeAtVisit ,2) > 80 then 7
		else 8 end as age_id
into #patients
from #covid_hsp hsp
left join #gluco_medications glucm on glucm.person_id = hsp.person_id 
left join omop.dbo.person p on p.person_id = hsp.person_id
left join omop.dbo.concept disch_disp on disch_disp.concept_id = hsp.discharge_to_concept_id
left join #gender gender on gender.covariate_id = p.gender_concept_id
left join #race race on race.covariate_id = p.race_concept_id
left join #ethnicity ethnicity on ethnicity.covariate_id = p.ethnicity_concept_id;

/**************************************************************************************************
Section 4:			Results
**************************************************************************************************/

--Section A: Results setup
if object_id('tempdb.dbo.#Exposure_variable') is not null drop table #Exposure_variable
select 0 [Exposure_variable_id], 'Glucocorticoid_medications' [Exposure_variable_name], 'no' [Exposure_variable_value]
into #Exposure_variable
union
select 1, 'Glucocorticoid_medications', 'yes'
;

if object_id('tempdb.dbo.#Outcome') is not null drop table #Outcome
select 0 outcome_id, 'Hospital_Mortality' outcome_name, 'discharged_alive' outcome_value
into #Outcome
union
select 1, 'Hospital_Mortality' , 'deceased_during_hospitalization';


--Results (Glucocorticoid_medications)
--Gender
	select @sitename Institution
	, m.covariate_name 
	, m.covariate_value 
	, m.Exposure_variable_name
	, m.Exposure_variable_value 
	, m.outcome_name Outcome_name
	, m.outcome_value Outcome_value
	, count(distinct visit_occurrence_id) EncounterCount
	, count(distinct person_id) PatientCount
	, @version Query_Version
	, @queryExecutionDate Query_Execution_Date
into #results
from (select * from  #gender
		cross join  (select * from #Exposure_variable where Exposure_variable_name ='Glucocorticoid_medications')a
		cross join #outcome
	) m
left join #patients p on m.Exposure_variable_id = p.Exposure_Variable_id
	and m.outcome_id = p.Outcome_id
	and m.covariate_id = p.gender_concept_id
group by m.covariate_name, m.covariate_value, m.Exposure_variable_name, m.Exposure_variable_value, m.outcome_name, m.outcome_value

union

--race
	select @sitename Institution
	, m.covariate_name 
	, m.covariate_value 
	, m.Exposure_variable_name
	, m.Exposure_variable_value 
	, m.outcome_name Outcome_name
	, m.outcome_value Outcome_value
	, count(distinct visit_occurrence_id) EncounterCount
	, count(distinct person_id) PatientCount
	, @version Query_Version
	, @queryExecutionDate Query_Execution_Date
from (select * from  #race
		cross join  (select * from #Exposure_variable where Exposure_variable_name ='Glucocorticoid_medications')a
		cross join #outcome
	) m
left join #patients p on m.Exposure_variable_id = p.Exposure_Variable_id
	and m.outcome_id = p.Outcome_id
	and m.covariate_id = p.race_concept_id
group by m.covariate_name, m.covariate_value, m.Exposure_variable_name, m.Exposure_variable_value, m.outcome_name, m.outcome_value

union

--ethnicity
	select @sitename Institution
	, m.covariate_name 
	, m.covariate_value 
	, m.Exposure_variable_name
	, m.Exposure_variable_value 
	, m.outcome_name Outcome_name
	, m.outcome_value Outcome_value
	, count(distinct visit_occurrence_id) EncounterCount
	, count(distinct person_id) PatientCount
	, @version Query_Version
	, @queryExecutionDate Query_Execution_Date
from (select * from  #ethnicity
		cross join  (select * from #Exposure_variable where Exposure_variable_name ='Glucocorticoid_medications')a
		cross join #outcome
	) m
left join #patients p on m.Exposure_variable_id = p.Exposure_Variable_id
	and m.outcome_id = p.Outcome_id
	and m.covariate_id = p.ethnicity_concept_id
group by m.covariate_name, m.covariate_value, m.Exposure_variable_name, m.Exposure_variable_value, m.outcome_name, m.outcome_value

union

--age range
	select @sitename Institution
	, m.covariate_name 
	, m.covariate_value 
	, m.Exposure_variable_name
	, m.Exposure_variable_value 
	, m.outcome_name Outcome_name
	, m.outcome_value Outcome_value
	, count(distinct visit_occurrence_id) EncounterCount
	, count(distinct person_id) PatientCount
	, @version Query_Version
	, @queryExecutionDate Query_Execution_Date
from (select * from  #age_range
		cross join  (select * from #Exposure_variable where Exposure_variable_name ='Glucocorticoid_medications')a
		cross join #outcome
	) m
left join #patients p on m.Exposure_variable_id = p.Exposure_Variable_id
	and m.outcome_id = p.Outcome_id
	and m.covariate_id = p.age_id
group by m.covariate_name, m.covariate_value, m.Exposure_variable_name, m.Exposure_variable_value, m.outcome_name, m.outcome_value
order by Exposure_variable_name, covariate_name, covariate_value, Exposure_variable_value,  Outcome_Name, Outcome_Value;

select Institution, covariate_name, covariate_value, Exposure_variable_name, Exposure_variable_value, Outcome_name, Outcome_value
	, case when @minAllowedCellCount = 0 then try_convert(varchar(20), EncounterCount)
			when @minAllowedCellCount = 11 and EncounterCount between 1 and 10 then '[1-10]' 
			when @minAllowedCellCount = 11 and EncounterCount = 0 or EncounterCount >=11 then  try_convert(varchar(20), EncounterCount)
			end as EncounterCount
	, case when @minAllowedCellCount = 0 then try_convert(varchar(20), PatientCount)
			when @minAllowedCellCount = 11 and PatientCount between 1 and 10 then '[1-10]' 
			when @minAllowedCellCount = 11 and PatientCount = 0 or PatientCount >=11 then  try_convert(varchar(20), PatientCount)			
			end as PatientCount
	, Query_Version
	, Query_Execution_Date
from #results
